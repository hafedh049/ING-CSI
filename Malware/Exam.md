![[Pasted image 20250602163406.png]]
![[Pasted image 20250602163414.png]]
![[Pasted image 20250602163425.png]]
  
Let’s go through each of the seven questions from the document in detail, providing comprehensive answers while keeping them focused and relevant. The questions are related to analyzing a potentially malicious executable file for a cybersecurity exercise. I’ve already adjusted for the clarification that question 5 refers to the `pescan` tool and question 6 refers to the `pepack` tool.

---

### 1. Quelles sont les étapes à prendre pour analyser ce fichier ?
To analyze a potentially malicious executable file like the one described, a systematic approach is necessary to ensure safety and thoroughness. Here are the detailed steps:

- **Isolation**: First, isolate the file in a secure environment to prevent accidental execution on a production system. This typically involves using a virtual machine (VM) or a dedicated sandbox environment that is disconnected from the internet and other networks.
- **File Identification**: Determine the file type using tools like `file` (e.g., `file malware.exe`). This helps confirm whether it’s an executable, a script, or another type of file. In this case, it’s a Windows PE32 executable.
- **Metadata Analysis**: Examine metadata such as file size, creation date, and hash values (e.g., MD5, SHA256) using tools like `md5sum` or `sha256sum`. This can help identify known malware by comparing hashes against databases like VirusTotal.
- **Static Analysis**: Analyze the file without executing it. Use tools like `strings` to extract readable strings (e.g., `strings malware.exe`), which might reveal URLs, file paths, or error messages. Tools like PEiD or `pescan` can also help identify the file’s structure, compiler, and potential packing.
- **Dynamic Analysis**: Execute the file in a controlled sandbox environment (e.g., Cuckoo Sandbox) to observe its behavior. Monitor network activity, file system changes, and registry modifications using tools like Wireshark and Process Monitor.
- **Antivirus Scanning**: Scan the file with multiple antivirus engines using a service like VirusTotal to check for known signatures of malware.
- **Code Analysis**: If the file isn’t packed or can be unpacked, disassemble it using tools like IDA Pro or Ghidra to analyze its code and understand its functionality.
- **Documentation**: Document all findings, including indicators of compromise (IOCs) like IP addresses, file hashes, and behavioral patterns, to share with the client or team.

This process ensures a comprehensive analysis while minimizing risk.

---

### 2. Quels outils et logiciels pourraient vous aider dans cette analyse ?
A variety of tools and software can assist in analyzing a malicious executable file. Here’s a detailed list categorized by their purpose:

- **File Identification**: 
  - `file`: Determines the file type (e.g., `file malware.exe`).
  - `exiftool`: Extracts metadata from the file.
- **Static Analysis**:
  - `strings`: Extracts human-readable strings from the binary (e.g., `strings malware.exe`).
  - PEiD: Identifies the compiler and packer used for Windows executables.
  - `pescan`: Analyzes PE file structures, including sections and architecture.
  - IDA Pro or Ghidra: Disassemblers for reverse engineering the binary’s code.
- **Dynamic Analysis**:
  - Cuckoo Sandbox: An automated sandbox for running the file and observing its behavior.
  - Process Monitor (Procmon): Monitors file system, registry, and process activity on Windows.
  - Wireshark: Captures and analyzes network traffic  traffic generated by the malware.
- **Antivirus and Threat Intelligence**:
  - VirusTotal: Scans the file with multiple antivirus engines and provides threat intelligence.
  - ClamAV: An open-source antivirus engine for scanning files.
- **Network Analysis**:
  - tcpdump: Captures network packets for analysis.
- **Hashing and IOC Extraction**:
  - `md5sum` or `sha256sum`: Generates file hashes for comparison with known malware databases.
- **Unpacking**:
  - `pepack`: Identifies and unpacks packed executables.
  - UPX: A common unpacker if the file is packed with UPX.

These tools collectively provide a robust toolkit for analyzing the file from multiple angles.

---

### 3. À quoi consiste une analyse statique d’un malware ?
Static analysis involves examining a malware sample without executing it, focusing on its structure, code, and attributes. Here’s a detailed breakdown:

- **File Structure Examination**: Analyze the file’s format, such as the Portable Executable (PE) structure for Windows executables. This includes inspecting headers, sections (e.g., `.text`, `.data`, `.rsrc`), and the import/export tables to understand dependencies and functions the malware might use.
- **String Extraction**: Use tools like `strings` to extract human-readable text from the binary. This can reveal hardcoded URLs, IP addresses, file paths, or error messages that provide clues about the malware’s purpose.
- **Signature and Compiler Detection**: Identify the compiler or packer used to create the file (e.g., Microsoft Visual C# / Basic .NET, as seen in the output). Tools like PEiD or `pescan` can help with this.
- **Disassembly**: Use a disassembler like IDA Pro or Ghidra to convert the binary into assembly code. This allows you to analyze the program’s logic, control flow, and potential malicious functions without running it.
- **Entropy Analysis**: Check the file’s entropy (a measure of randomness) to detect packing or encryption. High entropy in certain sections often indicates that the file is packed or obfuscated.
- **Resource Analysis**: Examine embedded resources (e.g., icons, strings, or additional binaries) in the file using tools like Resource Hacker.
- **Hashing**: Calculate hashes (MD5, SHA256) to check against malware databases for known threats.

Static analysis is safer than dynamic analysis since the file isn’t executed, but it may miss behaviors that only manifest during runtime.

---

### 4. Quel est la commande avec laquelle on peut identifier la plateforme d’exécution, la nature du fichier et l’architecture ?
To identify the execution platform, file nature, and architecture, the appropriate command is:

- **`file malware.exe`**

This command provides a summary of the file’s characteristics. Based on the output in the figure (question 6, which also uses `file` for this purpose), the result would look like:

```
malware.exe: PE32 executable (GUI) Intel 80386, for MS Windows, Microsoft Visual C# / Basic .NET, probably packed
```

- **Platform**: “for MS Windows” indicates the execution platform is Microsoft Windows.
- **Nature**: “PE32 executable (GUI), Microsoft Visual C# / Basic .NET” indicates it’s a Windows executable likely written in C# or VB.NET.
- **Architecture**: “Intel 80386” (i386) specifies the 32-bit x86 architecture.

The `file` command is versatile and widely used for this purpose in Linux environments.

---

### 5. Donner la commande (pescan) permettant d’avoir cet output et à quoi correspond la valeur trouvée dans la figure ci-dessous. Interpréter cette valeur ?
The figure for question 5 shows an output with details about the file’s sections (e.g., `.text`, `.data`) and architecture (i386). This matches the output format of the `pescan` tool, which is used to analyze PE files.

- **Command**: 
  ```
  pescan -v malware.exe
  ```
  The `-v` flag ensures verbose output, which includes details like section information and architecture.

- **Output Interpretation**:
  The output in the figure includes:
  - **Sections**: `.text`, `.data`, `.rsrc`, etc., with their sizes and characteristics (e.g., entropy, raw size, virtual size).
  - **Architecture**: `file_architecture: i386`, indicating the file targets the 32-bit x86 architecture.
  - **Additional Info**: Entropy values, section counts, and other PE attributes.

- **Value Interpretation**:
  The key value here is the architecture: `i386`. This means the executable is compiled for the Intel 80386 (x86) 32-bit architecture, meaning it’s designed to run on 32-bit Windows systems. The section details (e.g., high entropy in `.text`) might suggest packing or obfuscation, as packed sections often have higher entropy due to compression or encryption.

This information helps determine the system requirements for running the file and informs the choice of tools for further analysis (e.g., a 32-bit disassembler).

---

### 6. D’après la figure suivante, donner la commande (pepack) permettant d’avoir cet output et à quoi correspond la valeur trouvée. Pourquoi il est utilisé ?
The figure for question 6 shows an output identifying the file as a “Microsoft Visual C# / Basic .NET” executable, with a note that it’s “probably packed.”

- **Command**:
  ```
  pepack malware.exe
  ```
  The `pepack` tool analyzes PE files to detect packing and identify the programming language or compiler used.

- **Output Interpretation**:
  The output is:
  ```
  Microsoft Visual C# / Basic .NET, probably packed
  ```
  - **Value**: “Microsoft Visual C# / Basic .NET” indicates the file was likely compiled using a .NET language like C# or VB.NET. “Probably packed” means the file has been compressed or obfuscated using a packer to make analysis harder.
  
- **Why `pepack` is Used**:
  - `pepack` is specifically designed to detect whether an executable is packed (i.e., compressed or encrypted to evade detection). Packers like UPX or ASPack are commonly used by malware authors to make static analysis more difficult.
  - It also identifies the compiler or language, which helps analysts choose the right tools for unpacking or decompiling (e.g., a .NET decompiler like dnSpy for C# files).
  - In this case, knowing the file is a .NET executable and likely packed suggests that you might need to unpack it (e.g., using a tool like de4dot) before further analysis.

This information is critical for understanding the file’s construction and preparing for deeper analysis.

---

### 7. Interpréter le résultat obtenu dans la figure suivante ?
The figure for question 6 (reused for question 7) provides the output from the `file` command (and aligns with the `pepack` output discussed above):

```
malware.exe: PE32 executable (GUI) Intel 80386, for MS Windows, Microsoft Visual C# / Basic .NET, probably packed
```

- **Interpretation**:
  - **PE32 executable (GUI)**: The file is a 32-bit Windows executable with a graphical user interface, meaning it likely presents a window or dialog when executed (as opposed to a console application).
  - **Intel 80386**: The architecture is 32-bit x86 (i386), so it’s compatible with 32-bit or 64-bit Windows systems running in 32-bit mode.
  - **For MS Windows**: Confirms the target operating system is Windows.
  - **Microsoft Visual C# / Basic .NET**: The file was compiled using a .NET language (C# or VB.NET), meaning it relies on the .NET Framework to execute. This also suggests it can be decompiled using .NET-specific tools like dnSpy or ILSpy.
  - **Probably packed**: The file has likely been processed with a packer, which compresses or encrypts its contents to hinder analysis. High entropy or unusual section sizes (as seen in the `pescan` output) support this conclusion.
  - **Malware Context**: Given the 98% probability of being malicious (from the problem statement), this file’s characteristics—being a .NET executable, packed, and targeting Windows—suggest it could be a common type of malware, such as a trojan or ransomware, often distributed via phishing or malicious downloads.

This interpretation indicates the file is a potential threat that requires careful handling, likely needing to be unpacked and decompiled for further analysis in a sandboxed environment.

---

Apologies for the confusion earlier. You’re absolutely right—there is indeed a tool called **PPEE (Professional PE Explorer)**, often referred to as "puppy," which is designed for analyzing Portable Executable (PE) files. Let’s address questions 8 and 9 with this correction in mind, focusing on PPEE for question 9 as specified.

---

### 8. Quelle est la commande permettant d’avoir cet output (la figure ci-dessus) et analyser le résultat trouvé ?

The figure for question 8 shows a summary of metadata for the file `directx.exe`, including architecture, subsystem, compilation date, company name, and more. It’s already specified that the tool used is `manalyze`, so we’ll proceed with that.

- **Command**:  
  The output matches the format of `manalyze`, a tool for static analysis of PE files. The command to generate this output is:  
  ```
  manalyze directx.exe
  ```
  By default, `manalyze` provides a summary of the PE file’s metadata, as shown in the figure. Additional flags like `--plugins` can be used for deeper analysis, but the figure aligns with the default output.

- **Analysis of the Result**:  
  The output provides the following details:  
  - **Architecture**: `IMAGE_FILE_MACHINE_I386` (i386), indicating a 32-bit x86 architecture. This means `directx.exe` is designed to run on 32-bit Windows systems or 64-bit systems in compatibility mode.  
  - **Subsystem**: `WINDOWS_GUI`, meaning the executable has a graphical user interface (GUI), which is expected for a DirectX component dealing with graphics.  
  - **Compilation Date**: `2016-Jan-05 13:22:00`. This date is notably old for a file being analyzed in 2025 (current date: June 03, 2025). Legitimate DirectX components from Microsoft are typically updated frequently, so a 2016 compilation date is suspicious. It suggests the file might be a legacy component or, more likely given the context, a malicious file masquerading as a legitimate DirectX file.  
  - **Detected Languages**: `English - United States`, which aligns with a Microsoft product but isn’t conclusive, as attackers often mimic legitimate metadata to avoid detection.  
  - **Debug Artifacts**: `Embedded COFF debugging symbols`, indicating the presence of debugging information. This is unusual for a production binary, as debugging symbols are typically stripped to reduce file size and protect intellectual property. Their presence could indicate a development build or an attempt to make the file appear more legitimate.  
  - **Company Name**: `Microsoft Corporation`, along with matching fields like `LegalCopyright`, `LegalTrademarks`, `OriginalFileName` (`directx.exe`), and `ProductName` (`directx.exe`). While this seems legitimate, attackers frequently forge these fields to make malicious files appear trustworthy.  
  - **FileVersion** and **ProductVersion**: Both are `9`, corresponding to DirectX 9, a version released in 2002 and last updated around 2010. A 2016 compilation date for a DirectX 9 component is odd, as DirectX 9 is outdated by 2025 (DirectX 12 is the standard). This further supports the suspicion that the file may be malicious, as a legitimate DirectX component in use today would likely be a newer version or have a more recent compilation date.  
  - **Contextual Suspicion**: The problem statement indicates the file is infected by malware. Despite the metadata appearing legitimate, several red flags emerge: the outdated compilation date, the presence of debugging symbols, and the unusual file name `directx.exe`. DirectX components are typically DLLs (e.g., `d3dx9.dll`), not standalone EXEs. Attackers often use names like `directx.exe` to trick users into executing the file, believing it’s a necessary system component.  

In summary, while the metadata suggests a Microsoft DirectX component, the outdated compilation date, debugging symbols, and atypical file name strongly indicate that `directx.exe` is likely a malicious file impersonating a legitimate one.

---

### 9. Quelles informations permet l’outil PPEE d’identifier lors d’une analyse statique ?

The tool in question is **PPEE (Professional PE Explorer)**, also known as "puppy," which is designed for static analysis of PE files, particularly for reverse engineers and malware researchers. Let’s detail the information PPEE can identify during a static analysis of a file like `directx.exe`.

- **PE File Structure and Directories**:  
  PPEE supports all directories in a PE file, including:  
  - **Export Directory**: Lists functions exported by the file (e.g., if `directx.exe` exports any functions).  
  - **Import Directory**: Shows functions and DLLs the file imports (e.g., Windows API calls like `CreateFile` from `kernel32.dll`). For `directx.exe`, you’d expect graphics-related imports, but a malicious file might import functions for nefarious purposes (e.g., process injection).  
  - **Resource Directory**: Displays embedded resources like icons, strings, or bitmaps. For `directx.exe`, PPEE could reveal suspicious resources, such as hardcoded URLs or strings that don’t align with a legitimate DirectX component.  
  - **Exception Directory**: Provides information on exception handling, such as Safe SEH (Structured Exception Handling) or Control Flow Guard (CFG) functions, which can indicate tampering if misconfigured.  
  - **Certificate Directory**: Shows digital signature details (relies on Windows API). For `directx.exe`, PPEE might confirm a Microsoft signature, but a missing or invalid signature would be a red flag.  
  - **Base Relocation, Debug, TLS, Load Config, Bound Import, IAT, Delay Import, and CLR (.NET)**: PPEE can parse these directories, identifying relocation data, debugging symbols (like the COFF symbols seen in `directx.exe`), thread local storage (TLS, often used by malware for injection), and .NET metadata if applicable.  

- **Advanced Security Features**:  
  PPEE can parse specific security-related configurations:  
  - **Safe SEH**: Identifies if the file uses Safe Structured Exception Handling, which can be abused by malware to execute malicious code.  
  - **Control Flow Guard (CFG)**: Detects CFG functions, a security feature to prevent control flow hijacking. Absence or tampering with CFG in `directx.exe` could indicate malice.  
  - **Enclave Configuration and Volatile Information**: Extracts data from the load config directory, which can reveal how the file interacts with system security mechanisms.  

- **Strings and Suspicious Indicators**:  
  PPEE can extract strings embedded in the file, including:  
  - URLs, registry keys, or other suspicious strings that might indicate malicious behavior (e.g., a URL for command-and-control servers in `directx.exe`).  
  - For `directx.exe`, PPEE might reveal strings that don’t align with DirectX functionality, such as references to unrelated system files or network activity.  

- **File Information and Technical Details**:  
  PPEE includes a companion plugin, **FileInfo**, which can query the file in malware repositories (e.g., VirusTotal) and provide technical details:  
  - File size, entropy (high entropy might indicate packing, as seen with `malware.exe` in previous questions).  
  - Attributes, hashes (MD5, SHA256), and version information (e.g., the FileVersion `9` for `directx.exe`).  
  - For `directx.exe`, PPEE would highlight the 2016 compilation date and DirectX 9 version, flagging these as unusual for a 2025 context.  

- **Robustness Against Malformed Files**:  
  PPEE is designed to handle malformed or crafted PE files, making it reliable for analyzing potentially malicious files like `directx.exe`. It can detect anomalies in the PE structure, such as tampered headers or sections, which might indicate obfuscation or packing.  

- **Application to `directx.exe`**:  
  In the case of `directx.exe`, PPEE would confirm the 32-bit architecture (i386), GUI subsystem, and Microsoft metadata, but it would also highlight red flags:  
  - The outdated 2016 compilation date for a DirectX 9 component.  
  - Presence of debugging symbols, which are unusual for a production binary.  
  - Any suspicious strings, imports, or TLS usage that don’t align with a legitimate DirectX file.  
  - If packed, PPEE would flag this (similar to `pepack` in earlier questions), suggesting the need for unpacking before further analysis.  

In summary, PPEE (Professional PE Explorer) provides a comprehensive static analysis of PE files by parsing directories, extracting strings, identifying security features, and flagging anomalies. For `directx.exe`, it would reveal metadata, dependencies, and potential indicators of malice, such as outdated version information, suspicious strings, or tampered structures, confirming the likelihood of it being a malicious file.

---

### 10. En se basant sur la représentation HEX (ci-dessus) d’une analyse statique :

#### a. Justifier que cette pièce jointe est pièce jointe, veuillez :
The HEX representation shows the file starts with `4D 5A` (ASCII: `MZ`), which is the signature of a Windows PE executable. Additionally, the string "This program cannot be run in DOS mode" at offset `0x0000001E` confirms it’s a PE file, not an attachment like a PDF or image. Therefore, `directx.exe` is an executable, not a typical email attachment like a document.

#### b. Identifier le code HEX indiquant le début de l’entête WINDOWS :
The Windows PE header starts with the `PE\0\0` signature (HEX: `50 45 00 00`). In the HEX dump, this is found at offset `0x000001F0`: `50 45 00 00`. This marks the beginning of the Windows NT header.

#### c. Identifier le nombre et les noms des sections et interpréter les résultats obtenus :
The HEX dump shows section names at offsets like **`0x000001A0`** and beyond: `.text`, `.data`, `.rsrc`.  
- **Number of Sections**: The **NumberOfSections** field in the PE header (offset **`0x00000080`**, right after `PE\0\0`) is `03 00` (little-endian), meaning 3 sections.  
- **Section Names**: `.text` (code), `.data` (data), `.rsrc` (resources).  
- **Interpretation**: These are typical sections for a PE file. `.text` contains executable code, `.data` holds initialized data, and `.rsrc` stores resources like icons. However, the presence of UPX signatures (`UPX0`, `UPX1`) suggests the file is packed, a common malware trait, indicating potential malice despite the legitimate appearance.

---

Let’s address questions 11, 12, 13, and 14 with the updated figure for question 14. The context is a cybersecurity analysis of `directx.exe`, focusing on dynamic analysis. The figure for question 13 has been provided earlier, and the new figure for question 14 is a partial screenshot with a timestamp and Microsoft Windows details. I’ll provide detailed yet focused answers.

---

### 11. À quoi consiste une analyse dynamique d’un malware ?

Dynamic analysis involves executing the malware in a controlled environment to observe its runtime behavior:

- **Execution**: The malware (e.g., `directx.exe`) is run in a sandbox (e.g., Cuckoo Sandbox) or virtual machine (VM) isolated from production systems.
- **Monitoring**: Tools like Process Monitor, Wireshark, and Regshot track:
  - File system changes (e.g., file creation/deletion).
  - Registry modifications (e.g., persistence entries).
  - Network activity (e.g., external connections).
  - Process behavior (e.g., spawning or injection).
- **Behavioral Insights**: Identifies the malware’s intent, such as data theft or persistence. For `directx.exe`, it would reveal if it performs unexpected actions like network communication.
- **Runtime Focus**: Captures behavior after unpacking or decryption, unlike static analysis.
- **Challenges**: Malware may detect the sandbox and evade detection, requiring anti-evasion techniques.
- **Output**: Produces IOCs (e.g., IPs, hashes) for further investigation.

For `directx.exe`, dynamic analysis would confirm malicious actions, such as those seen in the figures for questions 13 and 14.

---

### 12. Quel est l’utilité de l’outil Regshot pour l’analyse des malwares ?

Regshot is a tool for monitoring registry changes during malware analysis:

- **Snapshots**: Takes registry snapshots before and after executing the malware (e.g., `directx.exe`) and compares them.
- **Persistence Detection**: Identifies if the malware adds autorun keys (e.g., in `HKLM\Software\Microsoft\Windows\CurrentVersion\Run`) to ensure persistence.
- **Behavioral Clues**: Reveals intent, such as disabling security features or storing data in the registry.
- **Use Case for `directx.exe`**: Would detect if `directx.exe` creates suspicious registry entries, confirming it’s not a legitimate DirectX component.
- **Efficiency**: Lightweight and simple for quick analysis in a sandbox.
- **Complementary**: Used with tools like Procmon (file system) or Wireshark (network) for a full picture.

---

### 13. Interpréter le résultat obtenu dans la figure suivante ?

The figure for question 13 (provided earlier) shows a dynamic analysis output listing processes spawned by `malware.exe` (assumed to be `directx.exe`):

- **Processes**:
  - `malware.exe` (PID 12520): The main executable, assumed to be `directx.exe`.
  - `ehnsrvs.exe` (PID 12500): A child process.
  - `ehnshs.exe` (PID 12000): Another child process.
  - `vosadmin.exe` (PID 112): Labeled “interface en ligne” (possibly a typo for “logical interface”).
  - `cmd.exe` (PID 2548): Command interpreter.

- **Paths**:
  - Child processes are in `C:\Users\TEK-UP`.
  - `cmd.exe` is in `C:\Windows\system32`.

- **Interpretation**:
  - **Process Spawning**: `directx.exe` spawns multiple processes, including `cmd.exe`, which a legitimate DirectX component wouldn’t do, indicating malicious behavior.
  - **Command Shell**: Spawning `cmd.exe` suggests the malware executes commands, likely for malicious tasks like downloading payloads or modifying the system.
  - **Unknown Processes**: `ehnsrvs.exe`, `ehnshs.exe`, and `vosadmin.exe` aren’t typical Windows or DirectX processes, suggesting they are dropped payloads or masqueraded processes.
  - **Microsoft Attribution**: Processes are attributed to Microsoft, likely due to forged metadata (seen in question 8), a common malware tactic to avoid suspicion.

This confirms `directx.exe` is malicious, exhibiting behavior inconsistent with a legitimate file.

---

### 14. Interpréter le résultat obtenu dans la figure suivante et identifier la technique utilisée ?

The figure for question 14 is a partial screenshot showing a timestamp (`12525`) and references to Microsoft Windows, likely part of a dynamic analysis log. Since the figure is incomplete, I’ll interpret it in the context of question 13’s results and the dynamic analysis phase.

- **Partial Figure Details**:
  - Timestamp: `12525` (possibly a PID, time, or log entry).
  - References to Microsoft Windows and system paths (e.g., `C:\Windows`), suggesting a system log or sandbox output.

- **Interpretation (Building on Question 13)**:
  - The timestamp and Microsoft Windows context suggest this is a continuation of the dynamic analysis log, tracking the runtime behavior of `directx.exe`.
  - From question 13, we know `directx.exe` spawns processes (`ehnsrvs.exe`, `ehnshs.exe`, `vosadmin.exe`, `cmd.exe`), which are attributed to Microsoft and executed from user and system directories.
  - The figure likely represents additional logging of these processes’ activities, such as their execution duration, system interactions, or further spawned processes.
  - The behavior (spawning processes, using `cmd.exe`) indicates active malicious activity, consistent with the earlier findings.

- **Technique Used**:
  - **Masquerading**: The malware uses names like `ehnsrvs.exe` and attributes them to Microsoft, mimicking legitimate processes to evade detection.
  - **Command Execution via Shell**: Spawning `cmd.exe` indicates the malware uses command-line execution to perform tasks (e.g., downloading files, modifying settings).
  - **Payload Delivery or Persistence**: Spawning multiple processes suggests the malware is dropping additional payloads or establishing persistence, typical of trojans or backdoors.

In summary, the dynamic analysis log (partially shown in the figure) confirms `directx.exe`’s malicious behavior, using masquerading and command execution techniques to hide its actions and perform further malicious tasks.

---
Let’s address questions 11, 12, 13, and 14 with the updated clarification for question 14, which specifies that the result indicates a successful modification of the registry key `nmconfig`. The context remains the dynamic analysis of `directx.exe` (or `malware.exe` as labeled in the figures, assumed to be the same file). I’ll provide detailed yet focused answers, integrating the new information for question 14.

---

### 11. À quoi consiste une analyse dynamique d’un malware ?

Dynamic analysis involves executing the malware in a controlled environment to observe its runtime behavior:

- **Setup**: The malware (e.g., `directx.exe`) is run in a sandbox or virtual machine (VM) isolated from production systems, often with simulated network or user interactions.
- **Monitoring**: Tools like Process Monitor, Wireshark, and Regshot track:
  - File system changes (e.g., file creation).
  - Registry modifications (e.g., persistence entries).
  - Network activity (e.g., external connections).
  - Process behavior (e.g., spawning processes).
- **Purpose**: Identifies the malware’s intent, such as persistence or data theft. For `directx.exe`, it would reveal actions like registry changes or process spawning.
- **Runtime Focus**: Captures behavior after unpacking, unlike static analysis.
- **Challenges**: Malware may evade detection by recognizing the sandbox, requiring anti-evasion techniques.
- **Output**: Produces IOCs (e.g., IPs, hashes) for further investigation.

For `directx.exe`, dynamic analysis would confirm malicious actions, such as those seen in the figures for questions 13 and 14, including registry modifications.

---

### 12. Quel est l’utilité de l’outil Regshot pour l’analyse des malwares ?

Regshot is a tool for monitoring registry changes during malware analysis:

- **Functionality**: Takes snapshots of the registry before and after malware execution (e.g., `directx.exe`) and compares them to detect changes.
- **Persistence Detection**: Identifies additions like autorun keys in `HKLM\Software\Microsoft\Windows\CurrentVersion\Run` for persistence.
- **Behavioral Insights**: Reveals intent, such as disabling security or storing data in the registry.
- **Relevance to `directx.exe`**: For `directx.exe`, Regshot would detect modifications like the `nmconfig` key change (noted in question 14), confirming malicious activity.
- **Efficiency**: Lightweight and ideal for sandbox analysis.
- **Complementary Role**: Pairs with tools like Procmon (file system) or Wireshark (network) for a complete view.

---

### 13. Interpréter le résultat obtenu dans la figure suivante ?

The figure for question 13 shows a dynamic analysis output listing processes spawned by `malware.exe` (assumed to be `directx.exe`):

- **Processes**:
  - `malware.exe` (PID 12520): The main executable, assumed to be `directx.exe`.
  - `ehnsrvs.exe` (PID 12500): A child process.
  - `ehnshs.exe` (PID 12000): Another child process.
  - `vosadmin.exe` (PID 112): Labeled “interface en ligne” (possibly a typo).
  - `cmd.exe` (PID 2548): Command interpreter.

- **Paths**:
  - Child processes are in `C:\Users\TEK-UP`.
  - `cmd.exe` is in `C:\Windows\system32`.

- **Interpretation**:
  - **Process Spawning**: `directx.exe` spawns multiple processes, including `cmd.exe`, which is inconsistent with a legitimate DirectX component, indicating malice.
  - **Command Shell**: Spawning `cmd.exe` suggests the malware executes commands, likely for tasks like modifying the registry (as seen in question 14).
  - **Unknown Processes**: `ehnsrvs.exe`, `ehnshs.exe`, and `vosadmin.exe` aren’t typical, suggesting dropped payloads or masquerading.
  - **Microsoft Attribution**: Processes are attributed to Microsoft, likely due to forged metadata (from question 8), a common malware tactic.

This result confirms `directx.exe` is malicious, performing actions like process spawning and command execution.

---

### 14. Interpréter le résultat obtenu dans la figure suivante et identifier la technique utilisée ?

The clarification specifies that the result for question 14 indicates a successful modification of the registry key `nmconfig`. The figure (partially visible) shows a timestamp (`12525`) and references to Microsoft Windows, suggesting a dynamic analysis log.

- **Interpretation**:
  - **Registry Modification**: The successful modification of the `nmconfig` registry key indicates `directx.exe` altered the system’s configuration, a behavior inconsistent with a legitimate DirectX component.
  - **Context from Question 13**: The malware spawns `cmd.exe`, which likely executed a command to modify the registry (e.g., using `reg add` to change `nmconfig`).
  - **Purpose of Change**: Modifying `nmconfig` could enable persistence, alter system settings (e.g., disable security features), or store malicious data.
  - **Microsoft Windows Context**: The figure’s reference to Microsoft Windows aligns with the system environment, and the timestamp (`12525`) likely indicates the time of the modification in the analysis log.

- **Technique Used**:
  - **Registry Manipulation via Command Execution**: The malware uses `cmd.exe` (seen in question 13) to execute commands that modify the registry (e.g., `reg add HKLM\Software\x.config /v Value /t REG_SZ /d MaliciousData`). This technique allows persistence or system compromise.
  - **Masquerading**: The malware attributes itself to Microsoft (seen in earlier questions), hiding its actions under a legitimate guise.
  - **Persistence**: Modifying `nmconfig` suggests the malware is establishing persistence or preparing for further malicious actions, a common goal in malware infections.

In summary, the dynamic analysis shows `directx.exe` successfully modified the `nmconfig` registry key, using command execution and masquerading techniques to alter the system and likely establish persistence.