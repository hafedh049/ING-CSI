# Exercice 5

![[Pasted image 20250115151207.png]]

Voici le chiffrement du message $X = 01101\ 11011\ 11010\ 00110$ en utilisant la fonction de chiffrement $E(b_1b_2b_3b_4b_5) = (b_2b_5b_4b_1b_3)$ avec les cinq modes : **ECB, CBC, CFB, OFB et CTR**. Le vecteur d'initialisation est $IV = 11001$.

---
### **1. ECB (Electronic Codebook Mode)**

In **ECB**, each block $X_i$ is encrypted independently:

$Y_i = E(X_i)$
#### Calculations:

1. $X_1 = 01101, E(01101) = b_2b_5b_4b_1b_3 = 10110$
2. $X_2 = 11011, E(11011) = b_2b_5b_4b_1b_3 = 11101$
3. $X3=11010X_3 = 11010, E(11010) = b_2b_5b_4b_1b_3 = 11100$
4. $X4=00110X_4 = 00110, E(00110) = b_2b_5b_4b_1b_3 = 01100$

Encrypted message $Y = 10110 \ 11101 \ 11100 \ 01100$.

---

### **2. CBC (Cipher Block Chaining)**

In **CBC**, each block is **XORed** with the previous ciphertext (or $IV$ for the first block) before encryption:

$Y_0 = IV, \quad Y_i = E(X_i \oplus Y_{i-1})$
#### Calculations:

1. $Y_0 = IV = 11001$
2. $X_1 \oplus Y_0 = 01101 \oplus 11001 = 10100, E(10100) = 01001$
3. $X_2 \oplus Y_1 = 11011 \oplus 01001 = 10010, E(10010) = 00110$
4. $X_3 \oplus Y_2 = 11010 \oplus 00110 = 11100, E(11100) = 10101$
5. $X_4 \oplus Y_3 = 00110 \oplus 10101 = 10011, E(10011) = 01110$

Encrypted message $Y = 01001 \ 00110 \ 10101 \ 01110$.

---

### **3. CFB (Cipher Feedback Mode)**

In **CFB**, the ciphertext is generated by XORing the plaintext with the encryption of the previous ciphertext (or $IV$):

$Y_0 = IV, \quad Y_i = X_i \oplus E(Y_{i-1})$
#### Calculations:

1. $Y_0 = IV = 11001$
2. $E(Y_0) = E(11001) = 10111, Y_1 = 01101 \oplus 10111 = 11010$
3. $E(Y_1) = E(11010) = 11100, Y_2 = 11011 \oplus 11100 = 00111$
4. $E(Y_2) = E(00111) = 01110, Y_3 = 11010 \oplus 01110 = 10100$
5. $E(Y_3) = E(10100) = 01001, Y_4 = 00110 \oplus 01001 = 01111$

Encrypted message $Y = 11010 \ 00111 \ 10100 \ 01111$.

---

### **4. OFB (Output Feedback Mode)**

In OFB, the ciphertext is generated by XORing the plaintext with the output of the encryption of the previous output (or $IV$):

$O_0 = IV, \quad O_i = E(O_{i-1}), \quad Y_i = X_i \oplus O_i$
#### Calculations:

1. $O_0 = IV = 11001$
2. $O_1 = E(O_0) = E(11001) = 10111,Y_1 = 01101 \oplus 10111 = 11010$
3. $O_2 = E(O_1) = E(10111) = 11101,Y_2 = 11011 \oplus 11101 = 00110$
4. $O_3 = E(O_2) = E(11101) = 01111,Y_3 = 11010 \oplus 01111 = 10101$
5. $O_4 = E(O_3) = E(01111) = 10010,Y_4 = 00110 \oplus 10010 = 10100$

Encrypted message $Y = 11010 \ 00110 \ 10101 \ 10100$.

---

### **5. CTR (Counter Mode)**

In **CTR**, a counter value is encrypted and XORed with the plaintext to produce the ciphertext. The counter increments for each block.

$O_i = E(IV + i), \quad Y_i = X_i \oplus O_i$
#### Assumptions:

Let the counter increment in binary (e.g., $IV+1, IV+2$, etc.).

1. $\text{Counter : }IV = 11001,O_1 = E(11001) = 10111,Y_1 = 01101 \oplus 10111 = 11010$
2. $\text{Counter: } IV + 1 = 11010,O_2 = E(11010) = 11100,Y_2 = 11011 \oplus 11100 = 00111$
3. $\text{Counter: }IV + 2 = 11011,O_3 = E(11011) = 11101,Y_3 = 11010 \oplus 11101 = 00111$
4. $\text{Counter: }IV + 3 = 11100,O_4 = E(11100) = 01100, Y_4 = 00110 \oplus 01100 = 01010$

Encrypted message $Y = 11010 \ 00111 \ 00111 \ 01010$.

---

### **Final Results**

1. **ECB:** $Y = 10110 \ 11101 \ 11100 \ 01100$
2. **CBC:** $Y = 01001 \ 00110 \ 10101 \ 01110$
3. **CFB:** $Y = 11010 \ 00111 \ 10100 \ 01111$
4. **OFB:** $Y = 11010 \ 00110 \ 10101 \ 10100$
5. **CTR:** $Y = 11010 \ 00111 \ 00111 \ 01010$


# Exercice 6

![[Pasted image 20250115154137.png]]
### **Given Information**:

1. Ciphertext: $C = 1101 \ 0100 \ 1100 \ 0100$
2. Key: $K = 00$
3. Initial Vector ($IV$) for **CBC** and **CTR**: $IV = 0000$
4. Decryption Modes: **CBC** and **CTR**.

The table specifies the mapping for $P$ (plaintext), $K$ (key), and $C$ (ciphertext). We will use $K = 00$ for all operations.

---

### **Step 1: Decrypting with CBC Mode**

#### CBC Decryption Formula:

In **CBC** mode, decryption uses:

$P_i = D(Y_i) \oplus Y_{i-1}$

Where:

- $Y_i = C_i$ (ciphertext block)
- $Y_{i-1}$ is the previous ciphertext block (or $IV$ for the first block).

#### Steps:

1. **Split $C$ into blocks**: $C_1 = 1101$, $C_2 = 0100$, $C_3 = 1100$, $C_4 = 0100$.
2. **For $K = 00$, use the table to find $D(C_i)$ (plaintext corresponding to each ciphertext block):**
    - $D(1101) \rightarrow P = 1011$
    - $D(0100) \rightarrow P = 1010$
    - $D(1100) \rightarrow P = 0101$
    - $D(0100) \rightarrow P = 1010$
3. Compute $P_i$ using CBC decryption:
    - $P_1 = D(C_1) \oplus IV = 1011 \oplus 0000 = 1011$
    - $P_2 = D(C_2) \oplus C_1 = 1010 \oplus 1101 = 0111$
    - $P_3 = D(C_3) \oplus C_2 = 0101 \oplus 0100 = 0001$
    - $P_4 = D(C_4) \oplus C_3 = 1010 \oplus 1100 = 0110$
#### CBC Decrypted Message:

$P = 1011 \ 0111 \ 0001 \ 0110$

---
### **Step 2: Decrypting with CTR Mode**

#### CTR Decryption Formula:

In CTR mode, decryption uses:

$P_i = C_i \oplus E(IV + i)$

Where:

- $E(IV + i)$ is the encryption of the counter ($IV + i$).

#### Steps:

1. **Initialize Counter**:
    - $IV = 0000$, so counters are $IV+1 = 0001$, $V+2 = 0010$, etc.
2. **Encrypt Counters $IV+i$ using $K = 00$:**
    - $E(0001) \rightarrow C = 0001$
    - $E(0010) \rightarrow C = 1110$
    - $E(0011) \rightarrow C = 1111$
    - $E(0100) \rightarrow C = 1010$
3. Compute $P_i$ for each block:
    - $P_1 = C_1 \oplus E(IV+1) = 1101 \oplus 0001 = 1100$
    - $P_2 = C_2 \oplus E(IV+2) = 0100 \oplus 1110 = 1010$
    - $P_3 = C_3 \oplus E(IV+3) = 1100 \oplus 1111 = 0011$
    - $P_4 = C_4 \oplus E(IV+4) = 0100 \oplus 1010 = 1110$

#### CTR Decrypted Message:

$P = 1100 \ 1010 \ 0011 \ 1110$

---

### **Final Results**:

1. **CBC Decrypted Message**: $P = 1011 \ 1101 \ 0001 \ 1100$
2. **CTR Decrypted Message**: $P = 1100 \ 0110 \ 0111 \ 1011$

# Exercice 7

![[Pasted image 20250115155205.png]]
#### **Question 1:**

_"**Y a-t-il des blocs au-delà de M2 affectés ?**"_

In **CBC mode**, if there is an error in the ciphertext block $C_1$, the decryption process propagates the error as follows:

- **Block $M_1$:** The error affects $M_1$ because it directly depends on the decryption of $C_1$.
- **Block $M_2$:** The error in $C_1$ affects $M_2$ because $M_2 = D(C_2) \oplus C_1$, meaning the corrupted $C_1$ is used in the XOR operation for decrypting $M_2$.

Beyond $M_2$:

- Blocks $M_3$, $M_4$, etc., are **not affected** because they only depend on $C_2$, $C_3$, etc., which remain uncorrupted.

**Answer:** Only $M_1$ and $M_2$ are affected; blocks beyond $M_2$ are **not affected**.

---

#### **Question 2:**

_"**Supposons qu’il y ait une erreur dans la version source de M1. Par combien de blocs de texte chiffré cette erreur est-elle propagée ? Quel est l’effet sur le récepteur ?**"_

In **CBC mode**, when encrypting, an error in the plaintext block $M_1$ affects:

1. The corresponding ciphertext block $C_1$, because $C_1 = E(M_1 \oplus IV)$.
2. The next ciphertext block $C_2$, because $C_2 = E(M_2 \oplus C_1)$, and $C_1$ is now corrupted.

Thus, the error in $M_1$ propagates to **two ciphertext blocks**: $C_1$ and $C_2$.

**Effect on the receiver:**

1. At the decryption stage, $C_1$ being corrupted causes $M_1$ to be decrypted incorrectly.
2. The corrupted $C_1$ also affects $M_2$ because $M_2 = D(C_2) \oplus C_1$.

**Answer:**

- The error in $M_1$ affects **two ciphertext blocks** ($C_1$ and $C_2$).
- At the receiver, this results in the corruption of **two plaintext blocks**: $M_1$ and $M_2$.